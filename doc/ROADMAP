Use this README file to introduce your application and point to useful places in the API for learning more.
Run "rake doc:app" to generate API documentation for your models, controllers, helpers, and libraries.


Etape actuelle :
OK - Il faut faire une mise en page de la saisie des lignes pour avoir le formulaire de saisie en une seule ligne
OK - Franciser le bouton créer ligne

OK - Voir comment on revient au menu des journaux

OK - Faire les validations avec les presences obligatoires

OK - Ordonner les listes de lignes par date.

OK - Changer l'épaisseur de border top dans les sous totaux
OK - Formater les valeurs dans la saisie des lignes

OK - Mettre en place la validation des écritures dans lines#index
OK - Revoir la place du plus dans lines#index
OK - Faire un sous menu mois pour les listings

OK - Après create il faudrait être dans le mois que l'on vient de saisir
OK - Mettre un ordre par défaut dans les selections destinations et natures
OK - Quand on fait +, mettre le bon mois dans le date select

A REPRENDRE COMPLETEMENT
OK Mettre en place des écritures avec répétition
  La logique est de faire une écriture mais avec des champs complémentaires dans le
formulaire : répéter pendant X mois/trimestres.
OK - A modifier : en fait c'est un champ copied_id qui doit être rempli de l'id de l'écriture mère
OK - plus un champ multiple booleen pour avoir un test facile
OK - Donc ajout d'une zone répétition avec un champ référence  plus
OK - les infos du nombre de périodes et la nature de celle ci.
OK - Ajout d'un champ reference dans le modèle
OK - Dans le controlleur, gestion des lignes d'écritures (ou faire un controller spécifique)

OK - Faire la mise en page de show multiple
OK - Faire le index
OK - Il faudra pour la modification : que l'on puisse supprimer une seule instance.

      Que l'on puisse supprimer toutes les instances futures.

OK - Problématique du edit/update
OK - Problématique du destroy
-------------------------------------------------------------------
OK - Mise en place des relevés de comptes
OK Traduction des éléments du formulaire relevé

POINTAGE DE COMPTES : Je crée une branche pointage car je ne suis pas trop sur de moi
OK  il faut passer en mode pointage => création d'un controlleur
OK  le controlleur doit avoir une action d'affichage des lignes du relevé et de celles qui sont non pointées
OK avec des comportements différents
OK action pour les pointages et dépointages sans javascript



- Partie javascript

OK -Supprimer les boutons et visualiser le mode pointage par un changement de forme du curseur

OK - Un clic associé la ligne
OK - un autre clic désassocie la ligne
OK - les soldes et les écarts sont recalculés
---------------------------------------------------------------------
OK - Faire une vue show de bank extract avec les lignes associées. Et les écarts de soldes. Très similaire donc à celle de pointage

OK - Lorsqu'on est bon, il devient possible de valider et verrouiller les associations. c'est dans le partiel _sold.js.erb
OK-  Visualiser le fait qu'on est bon par un changement de couleur du solde
OK -  Afficher un lien (bouton, icone) pour verrouiller le relevé bancaire
OK -  on ne peut pas accéder au pointage si le compte est validé
OK -  L'action verouiller doit modifier le champ validated de l'extrait et également celui des lignes associées
OK -  L'action renvoie ensuite à la vue show de bank_extract

--------------------------------------------------------------------


OK - Ajouter icone plus pour ajouter une écriture facilement avec une fenêtre superposée
OK -Mettre en place les bonnes icones pour le pointage
OK - Transformer listing en book
        changer le nom de la table par une migration et tous les liens listing id en book id
        changer le nom des fichiers vue/controller/modèles
        changer l'entête du modèle
        changer les routes
        changer les différentes apparitions de listing dans tous les autres fichier (listing, Listing, listings...).
OK Mettre en place une rubrique moyen de paiement dans les lignes




OK - Quand on est dans un livre, le menu devrait proposer les autres livres (déja fait)
OK - On devrait supprimer les icones dans l'affichage des lignes (ainsi que les fonctions lock et ce qui va avec)
OK - retrouver les images dans data_table
OK - internationalisation de data_table
OK - remettre les totaux de page (header et footer) - pour l'instant je n'ai fait que le pied de page. Il faut voir le besoin réel

OK - pick_date pour la saisie des lignes

OK - Aligner les soldes dans lines#index
Ok - Styler les lignes de soldes


-----------------------Affichage des données par type de dépenses ou de nature
OK - Faire un controlleur spécialisé.
OK - Doit afficher une table
OK - Recherche de lignes

--------------------------------------------------
OK- Revoir la navigation pour plus de confort
OK - Ajouter la possibilité de choisir une plage de date

--------------------- Faire une remise de chèques à la banque
OK    Création d'un modèle compte bancaire et intégration au logiciel
OK   Création d'un modèle remise chèque (migration/vue)
OK     On affiche les chèques qui ne sont toujours pas remis à l'encaissement
OK     On sélectionne ces chèques par boutons ce qui affiche le chèque dans la table supérieure
OK    Prévoir un bouton pour faire une sélection globale
OK  On valide, ce qui mène à la vue show
OK  La vue index affiche les remises faites.
OK    Le delete d'une remise doit enlever le ckeck_deposit_id des lignes
OK    Faire une redirection avec un flash si pas de chèque à remettre

--------------------Affichage journal de banque (BankLines) ------------------------
OK - Faire un controlleur avec vues index (peut être une sous classe de Lines
OK - Dépend de bank_account qui est un before filter
OK - Mettre un lien pour y accéder
OK - Avoir un scope des lignes qui trouve les lignes relevant d'un compte et de type bancaire
OK - Vue index
OK - Il faut impérativement faire un bank_account_id pour les lignes

----------------Modification du sous menu lines pour avoir l'année - ce qui renvoie à la logique des exercices
OK - j'introduis le modèle Period qui vient de comptasso et je l'adapte
OK - faire la migration
OK - faire les vues et adapter le controller
OK - on crée un helper qui fait l'affichage
OK - on met l'année dans une session lorsqu'on change d'année

-----------------------------------------------------------------------
OK Création du modèle cash pour faire des livres de caisse
OK - création du controller cash_lines pour afficher les mouvements en espèces
OK - Il existe déja un bank_account_id et il faudrait créer un cash_id

----------- aménagement formulaire de saisie des lignes --------------
OK - s'il n'y a qu'une caisse et qu'un compte bancaire pas besoin de sélectionner
OK - Saisie des écritures : mettre du java script pour faire la sélection avec du hidden et du show sur les champs cash et banques

-----------------révision du modèle de bank_line-------------
OK - Création d'une table bank_extract_line qui appartient à un bank_extract, 
OK - avec un champ rang, un champ line_id, un champ check_deposit_id
OK - hook after initialize pour remplir les infos selon que la ligne renvoie à une ligne ou à une remise chèque
OK - Une bank_extract_line affiche des infos simplifiées telles que line_date, narration, montant (on n'a plus la nature ni la destination)
OK - J'en suis au moment ou on peut afficher les infos dans le bank_extract#show.
OK - Il faut afficher d'un côté les écritures du relevé, de l'autres les écritures à pointer

OK - Quand on crée un relevé, l'action after create tente d'affecter les lignes qui ne sont pas déja sur un relevé
OK - Gestion ensuite de l'ajustement d'un relevé - améliorer les fonctionnalités
OK - Validation du relevé et verrouillage des lignes correspondantes
OK - Extract#show n'affiche alors plus que la tableau des bank_extract_lines

------------------------- Création de la zone admin ------------------------
OK - Mise en place de la zone
OK - mise en place du menu
OK - transfert des différentes actions dans la zone admin
OK - organism
OK -     book
OK - bank_accounts
OK - cash
OK - natures
OK - destination
OK - periods

----------------------------------------------------------------
OK - Mettre en place l'intitulé pour l'exercice dans le menu admin
OK - Ajouter exercices dans le menu public
OK - changer les actions previous_period et next_period en previous et next
OK - retrouver l'affichage des lignes des livres de recettes et dépenses
OK - Le passage de la zone admin à la zone public devrait conserver l'organisme
OK - La création d'un organisme devrait créer un exercice et deux livres par défaut
OK - Régler le bug de l'affichage de l'exercice (il n'est pas connecté à l'organisme)
OK - Voir pourquoi il refuse de supprimer un organism
OK - Supprimer la sélection de l'asset image pour les livres
OK - Mettre la description en title du lien book
OK - Faire en sorte que le mois soit correctement pris en compte par link_to_unless_current lorsqu'on arrive directt sur les lignes des livres
OK - Mise en forme du mois lorsqu'il est current
OK - Pointage ne doit apparaître dans le menu que s'il y a des comptes à pointer

OK - Traiter les cas de plusieurs comptes (Quand on enregistre une recette par virement il faudrait pouvoir enregistrer le compte concerné)
OK - : affichage du nom du compte bancaire dans le formulaire de saisie des lignes
OK - Il faut traiter l'affichage des différentes années


OK -Création de la sous classe Recettes (IncomeBook < Book)
OK - Création de la sous classe Dépenses
OK - Modification du form Book
OK - Modification de views/lines/_form pour n'afficher crédit
OK - Si on supprime une remise de chèques, il faut traiter les chèques
OK - Ajouter un lien pour avoir l'accès à la liste des remises chèques

OK - Retirer les liens entre books et bank_extracts (un bank_extract appartient à un organisme et à une banque mais pas à un livre)
OK - on ne peut pas éditer un compte bancaire (il n'y a pas d'accès)

OK - pick date mis en place d'une manière générale
OK - formulaire modifié pour bank_extract
OK - Indiquer le solde des comptes
OK - on pourrait supprimer le tri (et autres indicateurs visuels) pour la liste des comptes
OK - Quand on démarre l'affichage d'organisme est /organisms (car il n'y en n'a pas encore)
OK - Régler la problématique des images (dans l'affichage des livres) peut être avoir une dizaine d'images type
OK - Revoir navigation

OK - Faire les initiales pour le compte bancaire

OK - la rubrique écrire n'apparait que s'il y a au moins un compte ou une caisse
OK - Line new exige (à tort) qu'il y ait une caisse et un compte bancaire. Ne devrait pas être obligatoire. Modifier le form en conséquence.
OK - la rubrique espèces est disabled s'il n'y a pas de caisse
OK - Depenses écrire envoie sur afficher et non sur newline
OK - Pouvoir modifier les lignes non pointées
OK - Enlever le 1 qui s'affiche dans le formulaire new_line

OK - Le flash notice, la ligne a été créee pourrait être plus explicite (cas où on est interrompu et on ne sait plus très bien ou on en est).
OK - Revoir la date par défaut (qui devrait être liée au mois qu'on consulte et non à Date.today et prendre en compte les limites de l'exercices
OK - Dans le form new_line, il faudrait limiter les dates avec les limites de l'exercice.
OK - Il y a un bug dans l'affichage des exercices (qui semble ne pas prendre en compte un changement d'organisme) - en fait le line _new envoie sur l'index
     mais avec le mois de déc 2011 ! Et j'ai un lien avec mois =-1
OK - Le pointage ne marche pas bien quand il y a plusieurs relevés à pointer
OK - L'exercice n'est pas affiché dans la zone admin
OK Traiter la question du pointage des comptes dans la zone admin - que mettre ? Edition et suppression des comptes yc ceux pointés
OK - Enlever les icones modifier/supprimé pour un extrait verrouillé
OK - Mettre des icones à la place de verrouillé/déverrouillé.


JE LAISSE - L'affichage de l'exercice n'a pas forcément de sens pour des opérations non spécifiquement comptables comme une remise de chèque



---------------- Avoir accès au journal de caisse et pouvoir y faire des pointages (ou en tout cas un contrôle)
OK - remise en route de cash_lines#index
OK - Modifier le menu pour un accès à cash_lines
OK - Faire une fonction Controle pour la caisse et l'insérer dans le menu
OK - Créer une table cash_control et les accessoires (controller, vue, formulaire)
OK - Le pointage de caisse doit verrouiller les lignes

OK - Date min du dernier date_picker devrait être le dernier cash control ou le premier jour de l'exercice
OK - Date max le jour actuel ou le dernier jour de l'exercice
OK - Voir mise en forme du formulaire de saisie.
OK -  Mettre dans la zone admin l'accès à la liste des pointages de caisses
OK - Actuellement, il n'y a pas de destruction - fait dans la zone Admin
OK - Il faudrait faire une présentation avec les mois comme pour les cash_lines
OK - Rajouter une info sur le dashboard de organism
OK - Mettre en place un datatable pour cash_lines index
OK - Mettre en place une validation qui impose que le montant soit positif ou nul

-----------------------Edition papier livres, natures et destinations------------------------------------------------------------------------
OK - Faire le fond Brouillard - trouver comment avoir les images dans prawn
OK - Mettre en place les catégories dépenses et recettes pour natures - un boolean en fait
OK - Modifier les formulaires pour avoir les natures recettes pour les livres de recettes, et id pour dépenses
     Localisation (traduction) du formualire avec les boutons radio

Modifier l'approche des statistiques par natures
OK - il faut mettre stat dans le controller natures/destinations plutot que dans organism
OK - Créer une classe report avec un array des totaux par mois : en fait j'ai juste fait une méthode
OK - Refaire l'affichage de la vue
OK - Avec possibilité de filtrer par destination
OK - Transformer en datatable.
??   Supprimer l'affichage par page  ATTENDRE DE VOIR AVEC PLUS DE NATURESde datatable ? OU voir comment on peut faire un sorting intelligent (on affiche tout)
OK   Ajouter des totaux (voire des sous totaux)
OK   Problème il faut filtrer par destination donc revoir les méthodes ad hoc de période
OK   Supprimer la partie stat destination
OK - Traiter le pb du nombre de mois pour le highlight de datatable
OK   Modifier l'icone print pour le pdf de lines
??   Faire une version imprimée ??
??   Il faudrait un ordre pour les natures ??
--------------------------------------------------------------------------
--------------- Démarrage la partie compte/fisca---------------------
OK - création du scaffold account dans un namespace compta + migration
OK - revoir les modèles de templates pour les prochains scaffold
OK - faire l'espace de nom dans routes

OK - revoir le menu admin pour gérer cette ressource
OK - mettre les validations spécifiques
OK - Utiliser le hint de html5 (placeholder) et non le hint en dessous du champ de saisie de simple_form_for)
OK - modifier l'affichage de la table accounts (datatable ?)
OK - Régler problématique du tri des numéros de comptes
---------    permettre de charger les comptes à partir d'un fichier
OK - faire une class plan_comptable
OK - création d'un répertoire dans assets pour stocker les modèles de plan comptable
OK - modification des plan recopiés pour être compatible avec la nouvelle structure de table
OK - capable de lire les comptes à partir d'un fichier
OK - Period pouvant créer des comptes à partir du template fourni par ce fichier
OK - Modif du menu pour pouvoir utiliser cette fonctionnalité
?? transformation de cette classe en modèle avec des tables ?
--------------relier les natures et les comptes
OK - Oui : Devrait-on raccrocher les natures aux exercices ??
OK - intégrer les relations has_many natures et has_many lines through natures
OK - modification du form natures#edit
OK - les natures de type recettes doivent être rattachées aux comptes 7
OK - les natures de type dépenses ...
OK - revoir la vue index des natures
OK - faire du javascript pour mettre à jour la liste des comptes possibles
------------faire une vue de comptes à partir des lignes et des natures dans la partie compta
OK - faire un layout compta
OK - faire un accès
OK - faire le menu de la zone compta
OK - Afficher index comptes
OK - afficher show comptes (limité à la période)
OK - pas d'affichage du menu comptes s'il n'y a pas de comptes
OK - il faut que les natures soit reliées au compte de l'exercice en cours (et non à tous les comptes)
OK - ce qui pose le pb de la création ou de la mise à jour
    Vérifier que l'on a bien les lignes qu'il faut et pas d'un autre exercice
OK - prévenir si des natures ne sont pas associées à des comptes
OK - Faire un data table pour la liste des comptes
OK - déplacé la logique du mapping sur account
---- Refonte de nature - abandon du habtm -----------------------------------
OK - Faire la migration pour que nature soit rattachée à period plutôt qu'à organism
OK - Supprimer la table habtm
OK - Modifier les relations des modèles
OK - Modifier les routes
OK - Du coup, on peut créer de nature qu'avec un period
OK - Revoir les menus et les vues en conséquence
OK - Revoir la gestion du rattachement à partir de natures : en cours, faire la javascript
OK - Revoir la gestion gestion du mapping à partir de account : voir l'affichage
OK - La création du périod suivant doit dès lors recopier les comptes et les natures
OK - et rattacher les nouvelles natures aux nouveaux comptes de la même manière
OK - revoir le rattachement à nature deans la saisie des lignes - il en faut prendre que les natures de l'exercice
----------------     Proposer une balance
OK - faire une classe balance
OK - faire une méthode pour account qui calcule les totaux débit et crédit de ce compte
OK - controller balance
OK - vue balance
OK - introduire introduire la gestion d'une date et de compte pour la balance
OK - mis des liens pour l'affichage individuel des comptes
OK - A faire également dans le plan de compte
OK - Mettre des totaux aux colonnes de la balance - on pourrait faire une méthode balance_line dans account et avoir ainsi un hash dans la vue
OK - Faire la mise en forme de la vue balance (trait séparant les colonnes ? ou datatable)
OK - Impression de la balance avec prawn

-------------------CSV ----------------------------
OK - Recettes et dépenses du mois au format CSV
?? - Faire un export CSV des recettes ou dépenses de l'année

------------------------- Cloture d'exercice -----------------
Refaire une fonction lockable pour l'exercice
Revoir le menu car c'est une action rare
les règles sont
OK - que le pointage d'un compte bancaire doit verrouiller les lignes associées
NON  - que le pointage de caisse doit verrouiller automatiquement les lignes associées (voir commentaire sur les différentes situations dans le
        modèle cash_control
OK - les contrôles de caisse devraient pouvoir verrouiller les lignes correspondantes sans une action spécifique
OK - Le pointage d'une remise chèque devrait verrouiller les lignes correspondant à la remise de chèque
OK - il faut pouvoir verrouiller inidviduellement des lignes résiduelles
OK -  et donc les lister si nécessaire
OK - paeriod.lines ne marche pas car through natures et du coup ne trouve pas celles qui n'auraient pas de nature (faire que nature soit obligatoire).
OK - Changer lockable? en closable?
OK - Améliorer les messages dans le controller periods
OK - Revoir les validations pour interdire l'écriture sur les lignes (ou de nouvelles lignes) si l'exercice est clos.
---------------------------- Dashboard d'un organisme ------------------------
OK - Organiser la page en section
OK - Construire les graphes
OK - revoir le modèle remise de chèques
OK - gérer le remplissage des bank_account_id des lignes après remplissage ou pointage de la remise
OK - retirer de seeds les lignes avant le début de l'activité
OK - interdire cette possibilité dans le modèle line
OK - les graphes par défaut devraient tenir compte de la période
OK - insérer un nouveau div pour les graphes
OK - changer la classe graphe dans organsisms.js et dans show
OK - fair un helper pour l'affichage des graphes
OK - traiter le cas d'un seul exercice
OK - voir pour faire un plugin de la fonction graphe  javascript : en fait grande refactorisation
OK - rajouter les graphes pour les comptes bancaires
OK - transformer les méthodes graphiques en modules
OK - rajouter les graphes pour les caisses
OK - Faire un fichier seed.rb permettant de valider les graphes du dashboard
OK - indiquer que les extraits de compte bancaires sont pointés
OK - et rajouter quelques contrôles de caisse
OK - modifier seeds pour avoir deux caisses avec des mouvements différents
OK - inclure le sold dans le titre des pavés caisse et banque
OK - Retirer tous les messages des pavés et les regrouper - dans un div spécifique
OK - Le dashboard devrait proposer une icone pour faire une remise de chèque dans le pavé messages
OK - revoir ou on atterrit quand on clique sur compte bancaire
OK - Rendre les titres cliquables et/ou mettre les icones comme pour books.
OK - Faire une collections de paves pour pouvoir utiliser une fonction in_group_of
Mettre en place des formats adaptés pour les pavés de gauche, milieu et droite

--------------------- refonte de check_deposit--------------------
OK - revoir le modèle pour avoir les méthodes dans le modèle plutôt que dans le controller
OK - La vue index devrait proposer l'icone plus s'il y a des chèques
le menu banque - nouvelle remise de chèque devrait est indisponible si pas de chèque à remettre
??? Il faudrait interdire pick_all_checks si bank_account n'est pas dispo ?
OK - après up ou down dans un check deposit, il doit afficher l'action pointage

----------------------mise en place de bootstrap --------------------
OK - installation de twitter bootstrap
OK - refonte du layout public
OK - refont de layout admin
OK - refonte du layout compta
OK - modif des fieldset et legend sur toutes les vues


-------------------- FIXME ------------------------------------
OK - hover rend illisible le style des menus
OK - changer public en saisie/consult dans le menu admin et compta
OK - dans line#new voir comment on gère les erreurs avec nature blank?
OK - quand on rentre une date erronée, cela crée une erreur
OK - Le changement d'organisme devrait supprimer la session[:period]
OK -adapter lines csv à monthly_extract
OK - mettre un titre d'onglet plus adapaté pour les pdf
OK - Quand on enregistre un chèque, le champ banque ne devrait pas apparaître (ce devrait être lors de la remise)
OK - Affichage du message caisse <b>porte_monnaie<b> alors que je veux du gras
OK - Les icones des pavés sont passées à gauche
OK - Le menu admin n'identifie pas l'onglet sur lequel on est
OK - ajouter remises chèques dans le menu banques
OK - il faudrait une étoile pour les champs crédit et débit
OK - on ne peut plus modifier check_deposit - voir la question du validator cant change
OK - périod - suppression ne devrait pas eêtre dans le menu
OK - il faudrait un trait avant nouveau
OK - mettre suppression de period dans la table index des periods et revoir la mise en page
OK - on ne doit pas voir la proposition nouveau si on ne peut pas créer l'exercice
OK - reprendre le formulaire nature en utilisant l'astuce pour book pour les boutons radio
OK - réduire le menu admin livres à liste et nouveau puisque les actions sont dispo dans la liste
OK - Idem pour le menu banque et caisse qui sont maintenant cohérents

---------------------REVOIR TOUTES LES SPEC DES VIEWS SUITE AU PASSAGE A CAPYBARA
OK - admin bank_accounts index
OK - admin books index
OK - admin books new
OK - admin books edit
OK - admin destinations
OK - admin natures index
OK - admin periods new
OK - check_deposits lines organism users
-------------------------------------------------------------
Period#index ne devrait pas présenter clore comme action lorsqu'on vient de le créer et qu'il n'y a pas d'écritures.
Problème pour le changement d'exercice avec tentative (on arrive toujours au plus récent)
Quand il n'y a pas de chèque à remettre on peut cliquer sur nlle remise et il ne se passe rien
Modifier le style des liens vus dans les menus
il faudrait que l'erreur sur la date s'affiche au bon endroit si mauvaise date
admin_organism_index : l'icone restauration devrait avoir une flèche
----------------------------- admin natures ---------------------------------------
OK - dans admin#naturenew (form), le rattachement à un compte devrait être disable si pas de compte
OK - income_outcome doit être obligatoire
OK - la vue index ne doit pas proposer delete si des écritures sont rattachées à nature

quand on efface un organisme qui n'a pas d'exercice il y a une erreur

alignement des nombres dans les cash_control
OK - l'icone plus pour la remise de chèque déclanche une erreur
Traiter le cas où l'on n'a pas encore de banque (crée une erreur ?)

modifier la zone message pour que les messages soient générés par les modèles et non par le helper
OK - revoir la logique de archives (il semble qu'il subsiste une grande partie dans le contrôleur).
mettre des icones pour naviguer facilement entre les controles et l'affichage des contrôles de caisse
Dans la vue bank_extract.new, il ya un pb de mise en page des deux pick_dates
qaund on clique sur un élément il affiche à tort un changement d'exercice
OK - Quand on clique sur une colonne de graphe, on aboutit sur le bon mois mais pas forcément sur le bon exercice
Quand on est dans un exercice clos, on ne devrait pas pouvoir faire new_line (et le menu ne devrait pas nous le proposer)
revoir l'organisation des validators
OK - Dans la zone admin quand on affiche les natures, le hover sur les icones est vert foncé (id pour la partie zone compta) il faudrait bleu foncé.
OK - Destination show n'a guère de sens dans la partie admin (supprimer la vue et l'action ?).

-------------------- Virements internes --------------------------------
OK - mise en place du modèle et des vues et des spec associées
? afficher en javascript les soldes après transfert
OK - revoir du coup l'affichage de bank_extract_lines
OK - Mise en place de OdBook et création automatique à la création d'un organisme
OK - faire une fonction lines pour la classe Transfer
OK - faire un after update pour transfer
OK - Changer le titre virements en Transferts
OK - Livre OD ne doit pas avoir la possibilité d'écrire
OK - Adapter archive et restore pour pendre en compte les tansferts
OK - Problématique de transfer dont l'identification pour owner_id n'est pas évidente (il pourrait y avoir 2 transferts identiques le même jour).
OK - factoriser le modèle transfert (les lignes qui remplissent debitable et creditable)
OK - renommer les compta et autres restore en restorer
OK - confier la création du record au modèle avec les skip call back dans le modèle
find_id_for devrait envoyer un message d'erreur utilisable
OK - utiliser le helper de cash_lines pour lines
OK - request pour archive
OK - request pour restore
OK - Changer debit credit par dépenses recettes  dans le form par De vers
Dans les income outcome changer debit credit par montant (et une seule colonne).
utiliser des partials pour les menus (A finir pour zone admin et zone compta)
Voir pour l'affichage du livre OD (plutôt dans la compta ?)
Dans la vue admin#organisme, avoir une info sur la dernière activité
OK - Dans caisse# nouveau remplacer comment par commentaire

REVOIR LES BEFORE FILTER DE ORGANISM DANS LA ZONE ADMIN ET COMPTA
OK - La vue index des retraits d'argent n'est pas classée
OK - La liste des natures dans saisie de lignes devrait être classée par ordre alpha

J'ai pu créer dans les tests une ligne de dépenses en espèces qui n'avait pas de caisse
OK - Faire un module pick_date avec une méthode de classe
OK - Pour pouvoir supprimer tous les recours à picker_date
Vérifier que les controllers controlent bien la bonne classe

Généraliser la gestion des erreurs dans les picker_date sur la base de ce qui a été fait pour cash_control
OK - revoir bank_extract_controller_spec

----------------------CashControls----------------------------------------
OK - remplacer les modif de params[:pick_date] par des virtual attributes
OK - Mettre dans le modèle des méthodes min-date et max-date qui seront utilisées dans le form(ou dans le controller)
NON - Voir si organism peut répondre à une méthode active_period et donc à min_date et max_date
NON - Modifier les before_filter de application pour utiliser cette variable d'instance
OK - Revoir le fichier cash_spec (qui est une copie de bank_account_spec)
OK - Faire les spec du controller
OK - voir les messages d'erreur
OK - spec request
----------------------- BankExtract ------------------------------------
OK - on ne sélectionne plus le compte bancairela liste des comptes bancaires n'est pas lisibles dans le form et doit filtrer l'organisme en cours
OK - Voir la liste des arguments obligatoires - probablement reprendre les spec du modèles
OK - passer bank_extracts.js au tamis de JS lint
OK - suppresion de l'action et de la vue show (qui doit renvoyer à index de bank_extract_lines controller)
OK - filtrer les actions possibles selon le statut de lock
OK - tester dans une request la fonction de mise à jour du solde final
OK - spec_requests
OK - La saisie d'un montant sans décimales devrait être reformattée pour avoir deux décimales
OK - Après création on va vers index
BOF - Quand aucune banque n'existe, le menu Afficher (dans admin) devrait être disabled
OK - Supprimer le lien sur banque quand on est dans la zone saisie (le premier item du menu)
OK - Faire de même avec Livres et Caisses
OK - Supprimer les actions show correspondantes dans les routes, le controller et les vues pour bank_account
OK - On doit pouvoir effacer le controller bank_account de la zone public et donc les vues coorespondantes
OK - Suppression de ces mêmes actions pour book et cashes
OK - Les menus visités devraient rester en noir
OK - Sans compte bancaire, l'onglet banques ne devrait pas apparaître
OK - Sans extrait de compte, le menu banque ne devrait pas proposer de les afficher
OK - Nettoyage de routes concernant books et bank_extracts
NON Créer un after_save de la remise de chèques qui fait la liaison entre les lignes et le bank_extract ?
OK -  Peut-on supprimer un extrait bancaire pointé (actuellement on a l'icone) - réponse non, c'est bloqué
OK - Si on supprime un extrait bancaire cela met-il correctement à jour les lignes ? - les tests sont faits
A vérifier dans la console et sur la table jointe
Améliorer has_icon_matcher (affichage des erreurs, meilleure vérif du href)
OK - Contrôler le nombre de décimales
OK - Création du two_decimals_validator
OK Mettre en place ce validator dans les autres endroits où l'on renseigne des montants contrôle de caisse, écritures, et encore ?
OK - request spec pour l'action edit
-----------------------------BankExtractLine------------------------
OK - rendre plus complet ce controller en ayant une fonction index
OK - dans la vue index afficher les soldes et mouvements et signaler les éventuels écarts
OK - retirer les images danger lorsque le solde devient correct
OK - plus il faudra un bouton lock à un moment
OK - revoir l'architecture de check_deposit qui devrait être belongs_to bank_extract_line
OK - retirer le pointeur main sur les indicateurs de filtrage
OK - lui transférer les actions pointage et dépointage
OK - mettre en place des STI pour une BEL de type remise de chèque et une BEL de type line
OK - Faire une relation habtm avec les Line
OK - Revoir le javascript pour faire du drag and drop (pointage-dépointage)
OK - javascript pour déplacer une bel
OK - javascript pour afficher les sous lignes
OK - revoir les routes pour n'avoir plus que deux niveaux bank_extract_bank_extract_lines
OK - Verifier que remove une ligne chainée fonctionne correctement
OK - Faire les vues modales pour créer une nouvelle ligne
?? Faire que l'on puisse modifier une saisie de ligne
NON scinder une ligne - on attendra de voir si c'est utile
OK - Ajouter les icones pour appeler ces actions
OK - quand la table des écriture du bank_extract est vide, on ne peut pas faire un drag and drop
OK - modif de la classe Archive pour sauvegarder les infos de la table habtm
OK - création d'une méthode create_habtm pour restaurer les lignes
Ok - enlever bank_extract_id de check_deposit puisqu'on a le bank_extract par check_deposit_bank_extract_line
OK - Voir le doublon de np_check_deposit de bank_account qui se trouve aussi dans la class NotPointedLines
OK - Remove - insert- et ajoute ne remettent pas à jour l'écart sur les soldes (dans les tips)
OUI - Dans un relevé pointé peut on encore déplacer les lignes
OK - revoir natures.js (j'ai du commenter deux lignes pour éviter un problème dans la boîte modal)
OK - Tri par date ne marche pas correctement
OK - faire les spec de modallines controller
-----------------------Refonte mise en page suite à évolution bootstrap et firefox --------------
OK - Refonte des formulaires de la zone admin
OK - Reste restore à faire
OK - Faire également zone public
et zone compta (un seul formulaire dans balance)
OK - Fait un input spécifique pour radio buttons inline
OK - Revoir la mise en forme de toutes les tables
OK - refait le fichier railswatchr
OK - Effacer le fichier rails.watch.rb
OK - Fait un date_picker_input
OK - Affichage des erreurs dans les formulaires qui ont des dates (il faut faire errors.add(:pick_date ou similaire)

OK - utiliser pick_date_for dans le modèle line

--------------------- Remarques lors des essais ---------------------------
OK - caisse affichage des controles (revoir la mise en page)
OK - Faire une méthode écart de caisse
OK - dans l'index de cash_control, la vue courante n'est pas spécifiée lorsqu'on vient du menu général
OK - Dans Cash, monthly_value devrait s'appuyer sur Utilities::Sold
OK - Remplacer l'icone clé de cach control par l'icone Cadenas
OK - ne pas afficher index#controles dans le menu si il n'y en a aucun pour une caisse
OK - dans book.rb monthly_datas renvoie un hash et crée un array ?!
refaire une partie des models#book_spec avec des modèles réels et non des stub
NON - regarder l'utilisation de group by month pour obtenir directement les soldes mensuels (celà est faisable mais entraîne une dépendance à la base de données pour un avantage faible)
OK - Faire les spec de natures controller
OK - Faire du nettoyage dans le modèle Period
Dans utilitie::Graphic @chart_value_method n'est en fait jamais utilisé
OK - pb du tri sur la date dans transfer géré par aoColumDefs dans le datatable avec la classe date-euro pour le th de tete de colonne.
OK - revoir natures pour utiliser le filtre fourni par datatable (NON) et pouvoir trier sur la première colonne
NON La vue index dans Organism (zone public) ne semble pas utile (à Supprimer ?) . En fait elle sert lorsqu'on arrive sur root sans avoir choisi encore d'organisme
??  mais on pourrait aussi faire un redirect sur la zone admin.
OK - Quand on affiche un livre à partir d'un graphe, le mois actif n'est pas identifié
OK - Traiter le cas spécifique d'un exercice partiel => les données mois_year sont faites à partir du denier exercice
OK - retirer dans les graphiques les periods id qui ne sont plus utilisés
Voir si on fait le lien également sur les graphiques de type lines (bank et cash)
Dans modallines le form réaffiché est remis à blanc sauf la réf du chèque
OK - Mettre sPaginationType: bootstrap dans tous les appels à dataTable
OK - modifier la place de la pagination
Tester une page de bank_account avec plus de 10 éléments pour voir la mise en page
OK - repositionner la liste des mois dans les vues (un peu haut dans la ligne verte)
OK - Les bank_extracts validés ne devraient pas pouvoir être édités ni effacés dans la vue
OK - validation de bank_extracts dans le modèle avec blocage si locked
OK - Saisie des lignes - EN cas de nature non remplie, la page se réaffiche avec erreur mais la liste des natures prend toutes les natures
OK - Manque les impressions et le csv pour la caisse
OK - Manque les impressions et le CSV pour les statistiques
OK - Le pdf des statistiques ne doit être possible que pour les exercices de moins de 12 mois
Tester le pdf stat avec des natures en nombre suffisant pour être sur plusieurs pages
tester le pdf stat avec un organisme de moins de 12 mois et avec un de plus
Faire le choix de la police et choisir la truncate adhoc


OK - après la suppression d'une écriture, on est redirigé vers le mois an cours et non vers le mois affiché
OK - Dans l'index lignes on ne voit pas quel compte bancaire ou caisse est concerné
OK - Si on change le nombre d'écritures, il faudrait avoir cette valeur enregistrée dans un cookie pour les affichages futures
Rajouter un champ memonic pour BankAccount
En fait cash_id et bank_account_id devraient être polymorphiques

On pourrait faire des stats par destinations filtrées par natures (le pendant des stats par natures filtrées par dest)
??? Manque les impressions et le csv pour les extraits bancaires
Manque la possibilité d avoir un rapprochement bancaire
Mettre le focus dans new_line sur le champ date et faire passer le focus banque après le changement de mode de paiement
OK - Dans la saisie, le flash qui remet la date ne marche pas
OK - Le flash donnant les infos sur la saisie d'écritures n'apparaît pas
OK -Quand on modifie une ligne, on revient à l'index du mois actuel et non du mois de la ligne

OK - Revoir l'affichage data_table pour les organismes si plus de 10
OK - Le paiment par chèque doit afficher la banque et le champ référence
OK - Il faudrait pouvoir saisir une référence lors d'un paiement par chèque (le n° du chèque par ex)
OK - Et peut être aussi une référence de facture
OK - revoir l'affichage de cash_lines suite à l'insertion de ref
OK - Utiliser bootstrap pour l'affichage des flash
OK - Une ligne a pu être saisie sans mode de paiement - peut être ancien
on ne devrait pas pouvoir remettre un chèque qui n'appartient à aucun exercice
OK - ajouter l'id dans l'info qui suit la saisie d'une ligne
NON - Dans Line.rb, il y a un include validations (qui est dans lib/validators) qui gagnerait à être transformé en validator
    (faisable mais cette validation traite debit et credit à la fois donc c'est un peu plus compliqué
OK - Dans transferts : changer virement en transfert dans le flash et dans le titre h3 de index
OK - Classer les transferts par date
Transferts  : mettre un affichage par mois pour les virements  ?
Dans les graphiques, la caisse est affichée jusqu'à la fin de l'année
Largeur des colonnes dans la vue cashlines index

OK - Mettre les natures par ordre alpha dans la saisie d'écritures

Dans la sauvegarde, j'avais un cash control sans date, du coup, cela générait une erreur dans la restauration.
Les mois dans la zone h3 sont draggable
------------------- refonte des month_year -----------------------------
OK - Revoir tous les appels à MonthlyBookExtracts qui acceptent maintenant un hash
OK - modifier les appels à pdf et csv de lines
OK - voir new line (la date par défaut semble décalée d'un mois)
OK - revu pour utiliser MonthlyCashExtract qui ne semblait pas utilisé




--------------------------Partie comptable ----------------------------
OK - Ca commence par l'affichage du plan comptable dans la partie admin
OK - Le menu compte de admin ne doit plus proposer d'importer le plan comptable s'il y a des comptes
OK - Revoir le menu mapping (relier nature - recettes - dépenses, pourquoi 3 actions ?)
OK - refait les vues de mapping
OK - Revoir le form de account dans admin suite à bootstrap
OK - Vue Un compte ne devrait pas pouvoir être supprimé s'il a des écritures via les natures
Modèle : Un compte ne devrait pas pouvoir être supprimé s'il a des écritures via les natures
OK - Modifier le point de chute de compta : on arrive directement sur balance
OK - Création d'une action balance_new
OK - Refonte du formulaire avec usage de pick_date et de simple_form
OK - Afficher les comptes de façon plus lisible
OK - revoir le belongs_to_period_validator (incorporer dans line.rb un belongs_to period through book - non ne marche pas è fait un date_within_period_validator à la place
OK - modifier validations.rb pour harmoniser avec les autres
OK - Dans le modèle balance, il faut filtrer les comptes selon les données du formulaire
OK - Intégration au menu de new et révision de la balance show
OK - Retirer dans le menu organisme la liste des org et le caret
NON - Exercices n'a pas de sens s'il n'y en a qu'un; on laisse pour ne pas dérouter trop l'utilisateur
OK - Dans le menu exercices, il faudrait que les periods non accountables soient désactivés : en fait j'ai choisi de gérer le sujet dans le controller
OK - Compta ne devrait pas être accessible si on n'a pas créé de compte
OK - Mettre des validations dans le modèle balance
Spec balance - reste à faire le spec d'intégration
Spec listing
OK - Un listing ne devrait avoir qu'un seul compte - pas besoin de périod
OK - déplace le javascript de lines.js dans listing.js
Ok - déplacer le to_pdf de Account vers celui de Listing (rebaptiser Listing en ListingAccount ?)
OK - la balance PDF pourrait bien être systématiquement sur l'ensemble de l'année
OK - Voir pour le compte....
OK - Dans le listing du compte, ce qu'on veut c'est avoir en première page comme report  le solde du compte
OK - Attention à mettre à jour le lien pdf après modif par la boîte modale
NON - Dans admin, compta ne devrait proposer afficher que s'il y a des comptes (par contre fait pour relier aux natures)
OK - Dans compta, seuls les organismes avec les natures reliées devraient apparaître
OK - Refaire la table balance
OK - Revoir la partie affichages des comptes
OK - Faire un modèle listing (pour les comptes)
OK - Dans Base : faire order(line_date)
OK - Compta lines : utiliser data table,
OK - Compta listing :  modif des paramètres par modal form
OK - doit réinitier le datatable après mise à jour modale
OK - Ajouter un menu Compte dans les éditions
OK - Ajouter une édition du plan comptable (ce qui permet de faire un index des comtpes et un affichage)
OK - pdf pour les différentes impressions : plan comptable, listing, balance
OK - Vérifier le pdf de balance
OK - créer le csv de balance
OK - déplacé la gestion des truncate pdf via overflow de Prawn
OK - changer l'icone printer en icone pdf
OK - Ajouter un menu grand livre - uniquement pdf
OK - Solde_credit_avant et apres du modèle line.rb devraient être des scope ?
OK - Réorganiser les menus dans admin et compta comme pour public
OK - Modèle Line : voir les méthodes non utilisées
NON - Dans Book, has_many pending_checks relève du IncomBook (en fait le has_many ne semble plus marcher)
OK - Voir si les validators cant_change (oui), cant_edit (non) et cant_edit_field(non) sont utilisés
OK - Faire le ménage dans les vues de compta (lines, n'est pas utilisé, je pense)
--------------------première utilisation et ergonomie------------------------
NON - Faire un wizard (step) Trop compliqué
NON - Faire une base staging vierge pour tester l'ergonomie -> inutile maintenant que les organismes dépendent de user

---------------------PdfDocument ------------------------------
Faire un helper pour les export
Modifier Base pour en faire un Listing dédié à Account car il est devenu très spécialisé
NON - retirer la référence à Line dans base (puisque base est spécialisé account).
Refaire l'arborescence pour faire descendre base de simple (changer les noms ?)
OK - Revoir les truncate dans balance.pdf en utilisant :overflow=>truncate de Prawn
Dans balance, le stamp est automatiquement brouillard
Refaire les pdf des livres pour afficher correctement les soldes en utilisant la classe pdf_document
-------------------------Divers -----------------------------------------
Dans lines#index, les totaux n'ont pas de séparteur de milliers (ni les totaux globaux)
Dans l'écriture d'une recette de chèque, le champ banque ne devrait pas apparaître
Revoir l'affichage des totaux des lines par mois (on peut simplifier le javascript car le grand total est toujours le même)

----------------------Suppression d'un exercice-----------------
? Faire l'espace consult et l'espace saisie... Du coup saisie devient inactif pour un exercice clos
mais le pb est que les books sont des enfants de organism et non de period. A faire évoluer ?
Question les livres sont-ils dépendant de l'organisme ou d'un exercice ?
Question : que fait on des lignes qui ne sont pas validées par un relevé bancaire - par ex un chèque qui n'aurait pas été encaissé par le fournisseur

Est-il raisonnable de supprimer un exercice (à ce stade de développement)


-------------------- Sauvegarde/Restauration--------------------
OK - on doit être capable de sauvegarder les informations d'une entreprise sur un fichier et de pouvoir les restaurer - on commence par ça
OK - action dans la zone admin - modifier le menu sauvegarder - importer
OK - sauvegarder doit écrire un répertoire avec les fichiers avec les différentes infos des tables de l'organimes (ou plusieurs fichiers .yml -sql ?)
OK - restaurer doit lire le répertoire et vérifier qu'il trouve tous les fichiers puis créer les données si elle n'existent pas
OK - Si elles existent, la vue indique quelles données seront créées.
OK - Modifier le nom du fichier et voir le nettoyage du fichier temporaire
OK - Le logiciel doit indiquer de quand date la dernière sauvegarde
---------------------- Mise en place de login/logout ----------------------

NON ? Ajouter le champ user_id à organisme, migrer et faire les relations dans les modèles
OK - Ajouter une table des organismes à User (que l'on appelera rooms)
OK - La table doit avoir comme info le nom d'un fichier qui sera la base de données
OK - Franciser la vue Entrée pour avoir non pas create user mais Entrez ! et supprimer le titre
OK - Le flash doit disparaître quand on arrive sur la vue nouvel utilisateur
OK - Dans les login logout, le layout doit être différent pour ne pas faire apparaître les menus
BOF - Introduire dans find_organism une vérification que la base org appartient bien au current_user
------------------------Passage à une logique apartment mais en restant sous sqlite-------------------
OK - Les actions de création d'un organisme doivent gérer la question du room
OK - Ne garder qu'un seul organisme dans la base actuelle et modifier le nom du fichier
OK - Ajouter une vue login pour se logger ou s'enregistrer
OK - Mettre en place le partial pour afficher les liens logout login et qui est connecté
OK - Refaire l'affichage de la liste des organismes avec un helper
OK - Ajouter la logique de création d'un organisme dans le modèle :
OK - ajouter un champ database_name au formulaire new organism
OK - le create organism doit créer un room pour l'user, un fichier du nom de database
OK - se connecter à la base : puis faire la création.
OK - on reste sur cette base tant qu'on ne change pas d'user (ce sont des before_filter qui se charge de ce travail).
OK - Peut être modifier current_user pour être sûr qu'on a la bonne base
OK - Autre sujet : logout doit revenir à la base principale donc ajouter dans le session_controller les before qui reviennent à la base principale
OK -Revoir current_user dans application controller
OK - Réfléchir aux différentes actions de user/rooms/organism pour gérer les changements d'organisme
OK - La liste des exercices ne s'affiche pas dans le menu admin
OK - ajustement de upper_menu pour accéder aux autres parties
OK - refonte du controller organism de saisie/consult et
OK - reprendre le controller organism de compta
OK - revoir l'affichage des organismes dans le menu pour les zones compta et saisie/consult
OK - revoir les path des helpers des messages (organism_helper.rb:11) pour les adapter à room
OK - Faire une tâche rake pour faire les migrations sur toutes les bases
OK - probablement un bug dans l'affichage des organismes de la zone compta (le filtre accountable n'est peut être pas fiable)
OK - Traiter la problématique des tests
---------------Revue des tests
OK - Fait dans les controllers lines et natures (et peut être organisme)
OK - Revoir restore controller


------------------------------------------------------------------------------
OK - La vue description de l'organisme (zone admin) devrait indiquer le commentaire de l'archive
OK - etindiquer la dernière ligne d'écriture (plus stats ?)
OK - Ajouter une notice dans la vue new
OK - gérer la destruction d'un organisme qui devient différente
NON archive enregistre-t-il le nom du fichier sauvé ? => de toute façon l'utilisateur peut l'avoir modifié
OK - revoir le css des forms restore (et peut être archive)
OK - Le commentaire de la sauvegarde est semble-t-il inutilisé : maintenant si
OK - supprimer tous les use_org_connection pour utiliser le modèle room
OK - gérer l'erreur lorsqu'il n'y a plus le fichier (d'une manière générale, on pourrait envisager que les utilisateurs aient effacé le fichier)
OK - une manière de vérifier la qualité du fichier : le controlleur appelle maintenant check_db
------------------------ Bugs ----------------------------------------------
OK - ChangePeriod est à revoir dans LinesController car n'est plus adapté au format
NON    ? Faire un controller grapph qui servirait de relais vers lines ?? Non, ça passe par le redirect vers Period change et son back
OK - Le logout n'efface pas tous les éléments de session (base et period_id)
OK - les contrôles de caisse ne sont pas affichés par ordre de date

-------------------------Corrections--------------------------------------
stats du controller natures demande un org_id et un period_id qui ne sont plus vraiment utiles
OK - Revoir les erreurs dans les migrations (décimal et suppression d'un champ qui n'existe pas)
Par du javascript, dans la vue création archive, après clic, effacer le form et remplacer le bouton par un bouton retour

-----------------Dans restauration, modifier le formulaire pour demander l'écrasement ou non
Ajouter dans la vue la liste des database utilisée par ce current user
Avec jQuery afficher une fenêtre de confirmation si le nom est déjà pris

------------------------ cloture exercice -----------------------------------------------
OK - Ajouter un test closable? en début de méthode close
Close doit générer l'écriture de report du résultat (on solde les comptes 6 et 7 et on passe la contrepartie en compte de report à nouveau ou d'excédent...
Il s'agit donc de prendre les comptes 6 et 7 avec leur solde à la clôture de l'exercice et pour chaque compte créer une ligne
OK - Puis update de l'attribut closed à true
OK - Tout ceci dans une transaction
La notion de cloture comptable et d'écritures d'inventaire n'a de sens que si on passe une écriture partie écriture comptable
Tout ce qui est bilan suppose que la banque et la caisse aient un compte bancaire.
Dès lors, les opérations de fin d'exercice pourront se faire :
Impossible de faire une balance complète si trop d'écritures sans compte comptable.
Il faut que banque et caisse aient un compte bancaire : il faudra que account soit polymorphique as: accountable
Les lignes ont un compte bancaire.
Un after_create permet de remplir le compte si la nature est déjà reliée au compte.
Un observer natures met à jour les lignes si nature est reliée à un compte

Le pointage de compte fait locked mais il faut pouvoir encore le rattacher à un compte

On ne peut rentrer un relevé et des écritures bancaires que dans l'exerice. Donc on a un
solde au début de l'année et un en fin d'année.


OK - Ajouter un champ account_id, puis belongs_to account, et account has_many lines
OK - Faire un before_save qui remplit account_id en fonction de nature
OK - Faire un observer nature qui remplit Line si le rattachement de nature est fait après coup.
On ne doit pas pouvoir changer le rattachement de nature à un compte si locked et account_id rempli
Ceci dans les vues comme dans le modèle
OK - Si on modifie la nature d'une ligne, il faut que le account_id soit géré (fait par le before_save fill_account)
NON - Account doit être polymorphique pour pouvoir être détenu soit par un compte bancaire soit par une caisse
OK - Ajouter que BankAccount has_many accounts, as:account (il y a un compte par exercice)
OK - La création d'un compte bancaire doit créer un compte comptable (un par exercice),
NON : Le solde d'un compte bancaire ou d'une caisse se calcule en :
NON  - prenant en compte les lignes 6 et 7 qui ont ce bank_account_id (cash_id)
NON et en ajoutant les lignes qui ont des écritures avec ce compte (normalement des écritures d'inventaire uniquement)
NON - Les relevés de compte donnent lieu à passation d'écriture : on extourne le solde d'origine et on met le solde final.
OK - Les transferts peuvent être revus car maintenant on peut écrire deux lignes avec mention des comptes comptables
OK - Revoir le mode de calcul du solde d'un compte bancaire ou d'une caisse (vu qu'il y avait les transferts).
OK - Mise à jour des comptas existantes :
OK - les champs accounts_id de line doivent être remplis avec le account_id correspondant à l'exercice
OK - il doit y avoir création de compte pour la banque et la caisse pour les deux exercices.
Ok - Modifier l'affichage de caisses et banques pour montrer le numéro de compte
NON - Supprimer un compte bancaire ou une caisse devrait supprimer le compte comptable correspondant s'il n'y a aucune écriture : on ne supprime pas
OK - Idem pour Caisse et les contrôles de caisse

On doit avoir une balance équilibrée.

On peut alors revenir à la clôture : Fait les écritures d'ouverture (report des écritures de bilan et résultat de l'exercice)

On pourra alors faire des écritures d'inventaire : extraction de remboursement.

Modifier le module Utilities::Sold pour avoir une sélection des lignes correspondant à l'exercice.
Changer la date d'une ligne (en changeant d'exercice) va devoir gérer les natures et donc aussi les comptes account et counter_acount

------------ Suppression de bank_account_id et cash_id pour ne garde que counter_account_id (branche odbranch)-----------
OK - le callback check_bank_and_cash_id devient inutile, le formulaire donnant directement le compte de la caisse ou de la banque
OK - Les jQuery doivent être revus pour gérer le fait qu'il n'y plus qu'un champ - pas forcément
OK - Dans une dépense par chèque, il y a seulement la banque
OK - Dans une recette par chèque, ce ne peut être que chèque à l'encaissement
Ok - revoir jQuery dans transfert : sélectionner un item déselectionne le même dans l'autre liste
OK - Dans le form lines, couterpart apparaît mais n'est pas obligatoire
NON - Voir le after_create de Line qui ne remplit par counter_account
OK - Tous les appel à cash  doivent être en fait transformés en appel au counter_account
NON - Tous les appel  à bank_account doivent être en fait transformés en appel au counter_account
OK - Dans lines#index, le support doit être revu
revoir index.xls.erb pdf.prawn xslx.erb si incidence de support
OK - revoir l'édition d'un compte
OK - Dans Transfer revoir le after_create
OK - Modifier cash#sold_at
Revoir tout ce qui est balance ou grand livre (écran ou pdf) qui utilisent intensément les soldes
OK - Modifier lines empty? and all_lines_locked dans le modèle Account
OK - Dans la balance, les comptes 5 mouvementés devraient orienter vers l'affichage des écritures
OK - modifier check_deposit qui utilise abondamment bank_account_id pour marquer les lignes
----------------------- révision des remises de chèques ---------------------------------------
OK - La remise d'un chèque donne lieu à passation d'une écriture dans le journal d'OD
OK - Revoir comment pending_checks connaît les chèques disponibles à l'encaissement : prendre le compte 511 plutôt que lire les lignes de recettes
OK - Avec contrepartie le compte bancaire
OK - Le champ bank_account_id de check_deposit reste indispensable
OK - Le compte rem cheèques est 511 donc il faut modifier banques pour utiliser 512xx
OK - Period doit pouvoir retourner ou créer un compte remise chèque
OK - Faire une constante rem_check_account, pour aider à cette création
OK - tank_checks et target_checks ne semblent plus utile - supprimer
OK - Le message sur les remises de chèques n'est plus valable (dans la vue organism#show
OK - La création d'un check_deposit crée des lignes avec le check_deposit comme owner
OK - Une remise chèque pointée ne doit pas afficher l'icone modifier, ni supprimer
-------------------------pointage de relevé --------------------------------
OK - Le relevé doit avoir une date de début et de fin dans l'exercice
OK - Le scope period va devenir inutile (ou en tout cas grandement se simplifier)
OK - Il n'y a plus à faire de distinction entre bel (Standard et CheckDeposit)...
OK - Nettoyage fait dans le controller
OK - Faire le nettoyage des classes et vues (StandardBankExtractLine et CheckDepositBankExtractLine , plus aussi retirer les champs relevant de STI)
OK - Remplacer tous les standard et check_deposit par des standard_bank_extract_line
NON - on garde car pas un grand enjeu et pourrait reservir - Le modèle Utilities.not_pointed_lines n'est plus vraiment utile (on pourrait le remplacer par un helper)
OK - Revoir les questions de chaînage de lignes et de scission
OK - Verifie que Les fonctions insert et remove numarotent correctement les lignes  de la table des bels
OK - suppression de check_deposit_bank_extract_line_spec
OK - suppression de standard_bank_extract_line_spec
OK - Modifier pointed? dans Line qui doit se passer du champ bank_extract_id
OK - Verifier l'action de verrouillage d'un relevé bancaire
OK - Vérifier aussi l'action de contrôle de caisse
OK - Quand une ligne est pointée, on ne peut plus la supprimer ni l'éditer
on a le curseur main même pour les extraits pointés
OK - bug :le chainage quand on part de la fin masque des lignes
Recettes en chèque ne devrait pas être disponible dans la modal box
Le curseur pour le détail de lignes chainées n'est pas correct
Revoir l'affichage du détail de lignes chainées.

-------------------- on abandonne le counter_account pour passer à une logique d'écriture et de multilignes -----------------------
NON - Il faudrait des numéros d'écritures - qui peuvent être le numéro de la ligne mère ??? - on utilise owner
OK - Pour line, on peut garder le champ counter_account pour la saisie dans le formulaire mais on ne s'en sert plus ensuite
OK - Line after_create crée la contrepartie si on est dans une écriture de compta simplifiée (en fait si on est dans un livre IncomeBook ou OutcomeBook)
OK - gestion de line after_update (pour les contre lignes)
OK - Revoir Transfer qui doit écrire des lignes normales maintenant
OK - revoir support (qui n'est plus lisible directement)
OK - La logique cash ne doit plus utiliser les counter_account mais les comptes de caisse
OK - On revoit account qui redevient simple.
OK - On supprime  toutes les références à  counter_account dans les bank_account ou les cash

--------------------- on crée un livre de banque pour chaque banque et un livre de caisse pour chaque caisse --------------
OK - pour caisse et bank_account, la création entraîne celle d'un livre correspondant
OK - gérer la suppression des caisses et des comptes
OK - modifier update transfer
OK - modification des fonctions sold_at et monthly_value dans cash_book et income_book
OK - les contre écritures sont inscrites sur le livre correspondant du coup, book et monthly_book_extract n'ont plus besoin de filtrer difficilement
NON - Traiter le cas d'absence d'exercice précédent pour les graphes
NON - La création de compte 52 doit être accountable puisqu'on a besoin d'un livre....
-------------- suppresssion de la logique accountable ---------------------------------
OK - Ne plus faire un livre par caisse ou banque
OK - Supprimer les champs et les liaisons, ainsi que le after_create
OK - Supprimer les champs book_id de cash
OK - supprimer les champs book_id de bankaccount
OK - Revoir l'affichage d'un monthlyBookExtract
OK - Suppression des champs accountable_type et id pour cash et bank_account
OK - Dans l'édition de cash_book(pdf) ou xls/csv il faut modifier credit debit en entrée sortie
OK - Transfer peut voir sa structure changer avec par exemple from_account_id et to_account_id plutôt que des polymorphiques

------------- fin de cette mutation --------------------------------------------
?? Revoir les conditions d'édition d'un tansfert : doit on verrouiller les deux lignes du transfert alors qu'on ne pointe que la caisse ou que le compte bancaire
OK - La confirmation de suppression d'un transfert est encore en anglais
OK - Modifier PAs de support pour les lignes qui sont des chèques
Dans l'affichage du compte 511, on pourrait voir quels chèques sont pending
OK - Revoir la mise en forme de la table de détail des remises chèques
OK - Revoir dans cash le calcul des soldes pour les controles de caisse (vue new et index)
OK - Remettre en place les pavés cash et bank_account
OK - On n'utilise plus bank_extract_id dans le modèle check_deposit qui peut donc être supprimé
OK - Supportline ne semble pas répondre correctement pour les check_deposit (à revoir?)
OK - La création d un organisme crée une caisse et un compte bancaire
Dans la saisie des comptes, les natures associées devraient être disabled si on n'est pas dans un compte de classe 6 ou 7
OK - Inclure Utilities::Sold dans cash.rb
On devrait avoir un champ active pour les comptes (qui se répercute sur bank_account et cash)
OK - Création des comptes du plan comptable dès la création d'un period
Nettoyer le controleur, les routes et les vues de Period pour le plan comptable
OK - on peut supprimer les champs debitable_type et creditable_type de Transfer
OK - Les graphes ne permettent plus d'afficher le mois en question

toujours dans Transfer, on pourrait revoir les validators
Dans les exports de Lines#index vers des fichiers, on ne devrait pas faire un truncate des champs (vu le pb pour le champ support)
OK - supprimer to_option dans la caisse
OK - idem pour bank_account
0K - modalbox de account listing ne change pas le titre h3
NON - On pourrait voir comment se passer du champ counter_account
OK - Avoir un modèle comptaline qui s'appuie sur la table ligne mais qui serait utilisé en zone compta,
Nettoyer od_lines_controller ? et routes associées (fait-on de l'OD en zone saisie)
La suppression d'une compta ne semble pas supprimer la table sqlite associée
------------------------------------Bugs ----------------------------------------------------
Le modal form de balance ne redonne pas l'ensemble des comptes possibles mais seulement la partie de liste affichée
-------------------------------- Writing-------------------------------------------------------
OK - Créer un scaffold writing pour la partie compta
OK - writing_id sera être l'owner de la ligne
OK - Faire un form avec nested_arguments pour saisir une new écriture (avec nombre de lignes pouvant être augmenté ou annuler)
OK - Faire un partial pour writing
OK - S'inspirer de line pour afficher les flash notice avec previous_line et envoyer sur new
NON - Modifier l'icone plus pour en faire un bouton ?
OK - Le bouton créer ligne ne doit pas s'afficher si debit != credit
OK - L'écart devrait se mettre à jour et être affiché sur la page (ou inséré d'emblée dans le champ suplémentaire)
OK - Quand on verrouille une écriture, c'est l'ensemble des compta_lines qui doit l'être
Faire les spec de ça
Une compta_line doit avoir obligatoirement une writing
Quand on verrouille une compta_line, c'est l'ensemble qui doit l'être : ça doit être bon mais faire spec
OK - On doit avoir une action qui permet de verrouiller l'écriture
??? Une écriture qui n'est pas pointée et qui mouvement une caisse ou un compte bancaire ne devrait pas pouvoir être verrouillée...??
OK - Mettre les comptes par ordres de numéro
Faire un before_destroyable dans le modèle (et du coup retirer l'équivalent dans Transfer)
-------------------------------------- A nouveau ----------------------------------------------
OK - Une écriture d'à nouveau est forcément au premier jour de l'exercice
OK - solde de compte : Le solde d'ouverture est le montant donné par l'écriture d'à nouveau
NON ou par le solde de l'année précédente
NON du coup ceci uniquement pour les comptes de classe 1 à 5 - car alors on déséquilibre la balance

Le menu A nouveau doit prendre en compte les exercices

--------------------------------- TODO ---------------------------------------------------------
BOF _ L'affichage des comptes 1 à 5 n'a pas forcément besoin de nature et destination
On manque d'un affichage des écritures
OK - dans les vue book lines faire un recettes/dépenses plutôt que débit/crédit
OK - rajouter db:schema:dump à landlord:migrate_each
Quand on a des comptes et qu'on crée une nature, le lien au compte est disable dans le form
OK - Faire le readme
OK - Faire un menu bas
OK - Finaliser les éditions de balances avec Brouillard ou sans.
Vérifier les graphes et soldes avec deux exercices et des valeurs contrôlées.
OK - Traiter la clôture d'un exercice.
OK - Ajouter des index dans les migrations
OK - Les graphes de caisse ne devraient pas afficher toute l'année
Ajouter les environnements winusb et wininstall (cf. fichier Word sur mes essais pour les modifs à faire)
Il faudra faire les autres tâches rake db:migrate db:rollback,... correspondant au namespace landlord pour que
  les migrations fonctionnent correctement pour les bases déja installées.
OK - Ajouter un formulaire de saisie des lignes d'OD
OK - La confirmation de suppression de transfert est Are you sure?
OK - Dans la partie compta, on devrait avoir les journaux
-----------------------------------Gestion des user ---------------------------
La suppression d'un user doit être gérée (suppression des rooms, effacement des bases?)
-------------------------- Introduction du modèle écriture comme parent de Lines ------------
-- D'abord avec les transferts
OK - Modifier la table Writing pour en faire une table STI : ajout d'un champ type
OK - Le modèle Transfert devient alors un enfant de Writing
OK - modifier les routes car la hiérarchie est book/transfer et non organism/transfer
OK - modifier le menu general
OK - modifier le controller pour avoir book
OK - Modifier le formulaire avec des nested attributes/réutiliser le form de writing
OK - Adapter l'enregistrement existant
OK - refaire les spec
OK - Supprimer la table des transferts
OK - Ajouter une zone ref à Transfert

-- Remise de chèques
OK -  une remise chèque belongs_to writings : création de la migration
OK - et a des comtpa_lines à travers writings
OK - La remise de chèque doit créer une writing avec deux lignes
OK en profiter pour utiliser le module date_picker

-- line
OK - Ecrire une recette ou une dépense doit créer une writing avec une compta_line comme contrepartie
OK - Les controlleurs doivent utiliser writing et compta_line
OK - Modifier le form pour utiliser writing et compta_line
OK - Modifier les affichages des lignes pour utiliser date, narration ou réf de writing (voir delegate ?)
OK - idem pour book
OK - revoir Account qui utilise encore line et counter_line
OK - traite Utilities::Sold qui utilise line_date
OK - modifier les cash pour qu'il se passent de lines
OK - modifier  bank_accounts pour qu'ils se passent de lines
OK - faire la méthode cumulated_at pour OdBook

OK - Supprimer dans la table ligne le champ date, narration et ref (et les autres champs actuellement inutilisés)
OK - Revoir la méthode siblings et peut être children
On pourrait aussi revoir belongs_to bank_extract puisqu'il y a le lien via bank_extract_line
NON - Mettre une transaction dans counterpart, la counterpart est crée dans le controller via des params et non par le modèle
NON - Line pourrait appartenir à un writing plutôt qu'à un owner polymorphique
OK - Revoir previous_line_id dans le controller (create)
OK - Franciser les boutons des forms
OK - Faire les spec
OK - Revoir le javascript pour les champs banques et num chèque
OK - Revoir le modal form pour utiliser les nested attributes
OK - Pb de l'affichage des mois qui n'apparaît pas
Mettre une validation : InOutWriting doit avoir une in_out_line avec une nature
OK - Déplacer le + de création d'écritures vers la ligne des icones


Dans Account, la logique has_many Transfer n'a plus vraiment lieu d'être
OK - Account parle encore de counter_account_id
OK - monthlyCashExtract devrait utiliser les ComptaLine
-------------------------- Soldes au 01/01/2011 n'apparaissent pas ----------------------
En fait en enregistrant une écriture d'à nouveau, les soldes au 01/01 n'apparaissent pas car l'écriture est considérée comme une écriture de l'exercice

-------------------------- Finalisation de compta et de writings ----------------------
Revoir le menu
Gérer l'affichage des journaux pour les recettes et les dépenses
Pouvoir sélectionner des extraits (faire un formulaire ???) Controller LedgerExtract ???
le journal d'OD devrait afficher toutes les écritures relevant de OD
Voir gestion des tab dans le formulaire
Il faudrait éventuellement ajouter la ligne automatiquement
Changer Ligne créee... pour Ecriture créée dans le flash


------------------------- Journal Général----------------------------------
Faire un modèle general_ledger en s'inspirant de grand livre
Controller
Vue
Formulaire
Route
méthode to_pdf

-----------------------Détail de mise en forme ----------------------------
Revoir les rôles de title et description des books : title est OD, VE, et description Recettes, Achats,...

Il faudrait changer les InOutExtract et CashExtract pour les faire descendre de Extract::Base
OK è Transfer ne filtre pas sur les exercices
Quand un exercice est fermé, on ne doit pas avoir la possibilité de rentrer dans livres/écrire
Le grand livre devrait donner l'intitulé du compte et non seulement le numéro
OK - Dans compta/account le mouvement de la période inclut à tort le solde initial
Revoir la question du pointage des comptes sur les écritures à cheval
Pour le compte bancaire, le compte ne reprend que CMNE donc on ne les distingue pas
OK - Le solde des balances ne semble pas prendre en compte le dernier jour
Voir pour mettre les méthodes du module Sold dans account
Dans un new_bank_extract, les champs date ne sont pas dans l'exercice
Mise en page des tables dans le pointage de comptes
Mise en page de la fenêtre modale (dans pointage) : contrpartie est bizarrement placé
L'ajout d'une ligne modale doit afficher le numéro de ligne
Remise de chèques ne devrait pas apparaître dans le menu banques si on n'a pas de remise de chèque à faire
Ordre du menu : nouvel extrait, puis extrait puis remise chèque
L'affichage du relevé bancaire pointé devrait proposer l'icone plus
OK - Il n'y a plus d'endroit pour ajouter un compte
Dans la création d'un compte, le lien avec les natures ne devrait apparaître que si un compte 6 ou 7
Quand on a fini de relier les natures aux comptes, il faudrait que Compta apparaisse sans recharger la page
Quand un exercice est créé, on a dans les actions écritures non verrouillées
OK - Mettre en gras , l'organisme en cours dans la vue index de admin/organisme ...
Dans admin#organism#books, la flèche navigation 90 envoie vers la zone saise
Archives index - problème de mise en page de la table
DAns le formulaire Archive, un bouton Retour vers la liste serait plus agréable après l'enregistrement du fichier de sauvegarde
Quand le nom est trop long, la balance crée des pages en trop (faire un :overflow=>:truncate sur le pavé haut gauche
Dans la création de nature, lorsqu'il y a des comptes, il n'y a plus la possibilité de sélectionner le compte associé
La suppression de ligne devrait entraîner un flash (et surtout l'échec de la suppression)
Dans index organism, il n'y a plus la logique de renvoyer

-------------------------- éditions --------------------------
Dans le grand livre, les natures de devraient pas être indiquées (ni peut être les destinations) - on doit rester comptable
Dans le grand livre, mettre le libellé du compte en clair et pas seulement le numéro
Compte de résultat
Rapprochement bancaire


------------------Configuration ------------------------------
OK - watchr
OK - spork
OK - rspec
OK - création d'un script de lancement des différentes commandes
Jasmine -commencé l'installation mais pas fini car je n'ai pas actuellement de test à faire.
Il faudra surement adapter flc_launcher pour avoir le lancement de jasmine

--------------------Divers---------------------------------------------------------------------------
Nettoyer old_bootstrap.css en modifiant bootstrap.css
Dans period, copy_accounts devrait être dans une transaction
Dans Period, closable? devrait vérifier que tous les comptes 1 à 5 sont là
OK - Revoir la page index de organism (title et mise en page) : en fait je l'ai supprimée dans la partie consult
OK - supprimer la session de period
On devrait bloquer la création d'organisme à un
De même pour OdBook : un seul livre d'OD
Factoriser les Utilities Extract
Factoriser les jQuery datatable
Le datatable de compta#lines ne marche pas
? - Datatable  pour la balance
faire des tests pour pick_date_for et le transformer en gem
OK - Revoir la vue index de nature dans public qui propose des actions qui relèvent de admin
OK - Peut être idem pour destination : suppression controller et vue de saisie/consult
Il serait plus judicieux de faire un stat controller car le controller nature n'a plus qu'une méthode stats
et stats traite de natures et de destinations
OK - Faire une classe month pour Period ? : en fait c'est la classe MonthYear
-----------------------------------------------------------------

Gérer les income et outcome book avec un controller dédié et des formulaires pour créate et update différents
(avoir un form qui demande le type pour la création, mais pas pour l'édition)
OK - quand on crée une écriture, le bouton créer remet new (ce qui est une bonne idée, mais il faudrait qu'il conserve la date
Voir si les deux fonctions two_decimals et debit_credit ne sont pas redondantes.
OK - Problématique des deux cartes (Amex et CB) en fait c'est un autre compte et le pb est un pb de virement entre les deux.
OK - Problématique des retraits espèces ... (qui est un transfert)
Revoir ou supprimer old_seeds

Quand on saisit plusieurs fois le même montant, on pourrait avoir un bouton qui affiche
la même trame de ligne (soit un bouton spécifique, soit un mode de saisie).

Voir si les logiques de lock des lines ont encore du sens


Changer income et outcome en sales and expenses
NON - Rebaptiser bank_extract_lines en bank_lines; C'est une mauvaise idée car bank_lines a un sens: cela correspond aux lignes construite à partir de lines et non de bank_extracts

Voir le mois qui est affiché quand on supprime une écriture

Utiliser la logique TSI pour distinguer les différents types de listings (et de lignes?)
A refaire ou revoir - Faire que la touche plus puisse être actionnée par le clavier

---------------------pick date et autres goodies

Faire que la modif se fasse dans une modalbox



-------------------------- Autres sujets à moyen terme
Mettre en place une validation globale de la page

Mettre en place un contrôle md5 sur les sauvegardes et les restaurations.

OK - Créer des natures de recettes et des natures de dépenses

Gérer les validations
Ne pas pouvoir supprimer une remise chèque qui a été pointée
OK - gérer le problème du edit des check_deposit : si on modifie les chèques remis et qu'on abandonne, en fait c'est quand même enregistré.
Mettre dans le modèle une validation qui empêche la modification si verrouillé

Saisie par templates : peut être faire des modèles achats/ventes/banques/caisse
et des modèles de lignes (repetées, multiple).

Il faudrait afficher l'icone imprimer dès lors qu'il y a un chèque dans la table des remises