<div class="champ">
  <h3>
    Statistiques par natures
  </h3>
  <div class="inner-champ row-fluid">

    <%= form_tag stats_organism_period_natures_path(@organism, @period),:method =>:get, :class=>"span12"  do %>
 <!--     <label for="destination" class="span2 control-label">Destination</label> -->
      <%= select_tag :destination, options_for_select([['Toutes destinations', 0]] + @organism.destinations.collect {|d| [d.name, d.id]}, @filter), :class=>'span3' %>
      <%= submit_tag 'Rafraichir', :class=>'btn-primary btn span2' %>
    <% end %>
      
  </div>
</div>

<div class="row-fluid">

  <table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered table-condensed data_table" >
    <thead>
      <tr>
        <th class="span2">Nature</th>
        <% @period.list_months('%b %y').each do |my| %>
          <%=  content_tag :th, my  %>
        <% end %>
        <th>Cumul</th>

      </tr>
    </thead>

    <tfoot>
      <tr class="total" id="totaux">
        <th>Total Recettes <br />Total Dépenses<br />Total Différence </th>
        <% @total_recettes.size.times do |index| %>
          <th class="numeric">
            <%=  debit_credit @total_recettes[index] %><br />
            <%=  debit_credit  @total_depenses[index] %><br />
            <%=  debit_credit(@total_recettes[index]+@total_depenses[index])  %></th>
        <% end %>
      </tr>

    </tfoot>

    <tbody>

      <% @recettes.each do |r| %>
        <tr>
          <td><%= r.name %></td>
          <% r.stat_with_cumul(@period, @filter).each do |val| %>
            <%=  content_tag :td, debit_credit(val), :class=>'numeric'  %>
          <% end %>
        </tr>
      <% end %>
        
      <% @depenses.each do |r| %>
        <tr>
          <td><%= r.name %></td>
          <% r.stat_with_cumul(@period, @filter).each do |val| %>
            <%=  content_tag :td, debit_credit(val), :class=>'numeric'   %>
          <% end %>
        </tr>
      <% end %>


    </tbody>


  </table>

</div>

