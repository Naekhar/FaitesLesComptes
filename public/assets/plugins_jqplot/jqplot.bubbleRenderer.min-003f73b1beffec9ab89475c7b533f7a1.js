/**
 * jqPlot
 * Pure JavaScript plotting plugin using jQuery
 *
 * Version: 1.0.0b2_r1012
 *
 * Copyright (c) 2009-2011 Chris Leonello
 * jqPlot is currently available for use in all personal or commercial projects 
 * under both the MIT (http://www.opensource.org/licenses/mit-license.php) and GPL 
 * version 2.0 (http://www.gnu.org/licenses/gpl-2.0.html) licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly. 
 *
 * Although not required, the author would appreciate an email letting him 
 * know of any substantial use of jqPlot.  You can reach the author at: 
 * chris at jqplot dot com or see http://www.jqplot.com/info.php .
 *
 * If you are feeling kind and generous, consider supporting the project by
 * making a donation at: http://www.jqplot.com/donate.php .
 *
 * sprintf functions contained in jqplot.sprintf.js by Ash Searle:
 *
 *     version 2007.04.27
 *     author Ash Searle
 *     http://hexmen.com/blog/2007/03/printf-sprintf/
 *     http://hexmen.com/js/sprintf.js
 *     The author (Ash Searle) has placed this code in the public domain:
 *     "This code is unrestricted: you are free to use it however you like."
 *
 * included jsDate library by Chris Leonello:
 *
 * Copyright (c) 2010-2011 Chris Leonello
 *
 * jsDate is currently available for use in all personal or commercial projects 
 * under both the MIT and GPL version 2.0 licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly.
 *
 * jsDate borrows many concepts and ideas from the Date Instance 
 * Methods by Ken Snyder along with some parts of Ken's actual code.
 * 
 * Ken's origianl Date Instance Methods and copyright notice:
 * 
 * Ken Snyder (ken d snyder at gmail dot com)
 * 2008-09-10
 * version 2.0.2 (http://kendsnyder.com/sandbox/date/)     
 * Creative Commons Attribution License 3.0 (http://creativecommons.org/licenses/by/3.0/)
 *
 * jqplotToImage function based on Larry Siden's export-jqplot-to-png.js.
 * Larry has generously given permission to adapt his code for inclusion
 * into jqPlot.
 *
 * Larry's original code can be found here:
 *
 * https://github.com/lsiden/export-jqplot-to-png
 * 
 * 
 */
(function(a){function d(a,b,c){a.plugins.bubbleRenderer.highlightLabelCanvas.empty();var d=a.series[b],e=a.plugins.bubbleRenderer.highlightCanvas,f=e._ctx;f.clearRect(0,0,f.canvas.width,f.canvas.height),d._highlightedPoint=c,a.plugins.bubbleRenderer.highlightedSeriesIndex=b;var g=d.highlightColorGenerator.get(c),h=d.gridData[c][0],i=d.gridData[c][1],j=d.gridData[c][2];f.save(),f.fillStyle=g,f.strokeStyle=g,f.lineWidth=1,f.beginPath(),f.arc(h,i,j,0,2*Math.PI,0),f.closePath(),f.fill(),f.restore(),d.labels[c]&&(a.plugins.bubbleRenderer.highlightLabel=d.labels[c].clone(),a.plugins.bubbleRenderer.highlightLabel.appendTo(a.plugins.bubbleRenderer.highlightLabelCanvas),a.plugins.bubbleRenderer.highlightLabel.addClass("jqplot-bubble-label-highlight"))}function e(a){var b=a.plugins.bubbleRenderer.highlightCanvas,c=a.plugins.bubbleRenderer.highlightedSeriesIndex;a.plugins.bubbleRenderer.highlightLabelCanvas.empty(),b._ctx.clearRect(0,0,b._ctx.canvas.width,b._ctx.canvas.height);for(var d=0;d<a.series.length;d++)a.series[d]._highlightedPoint=null;a.plugins.bubbleRenderer.highlightedSeriesIndex=null,a.target.trigger("jqplotDataUnhighlight")}function f(a,b,c,f,g){if(f){var h=f.seriesIndex,i=f.pointIndex,j=[h,i,f.data,g.series[h].gridData[i][2]],k=jQuery.Event("jqplotDataMouseOver");k.pageX=a.pageX,k.pageY=a.pageY,g.target.trigger(k,j);if(g.series[j[0]].highlightMouseOver&&(j[0]!=g.plugins.bubbleRenderer.highlightedSeriesIndex||j[1]!=g.series[j[0]]._highlightedPoint)){var l=jQuery.Event("jqplotDataHighlight");l.pageX=a.pageX,l.pageY=a.pageY,g.target.trigger(l,j),d(g,j[0],j[1])}}else f==null&&e(g)}function g(a,b,c,f,g){if(f){var h=f.seriesIndex,i=f.pointIndex,j=[h,i,f.data,g.series[h].gridData[i][2]];if(g.series[j[0]].highlightMouseDown&&(j[0]!=g.plugins.bubbleRenderer.highlightedSeriesIndex||j[1]!=g.series[j[0]]._highlightedPoint)){var k=jQuery.Event("jqplotDataHighlight");k.pageX=a.pageX,k.pageY=a.pageY,g.target.trigger(k,j),d(g,j[0],j[1])}}else f==null&&e(g)}function h(a,b,c,d,f){var g=f.plugins.bubbleRenderer.highlightedSeriesIndex;g!=null&&f.series[g].highlightMouseDown&&e(f)}function i(a,b,c,d,e){if(d){var f=d.seriesIndex,g=d.pointIndex,h=[f,g,d.data,e.series[f].gridData[g][2]],i=jQuery.Event("jqplotDataClick");i.pageX=a.pageX,i.pageY=a.pageY,e.target.trigger(i,h)}}function j(a,b,c,d,f){if(d){var g=d.seriesIndex,h=d.pointIndex,i=[g,h,d.data,f.series[g].gridData[h][2]],j=f.plugins.bubbleRenderer.highlightedSeriesIndex;j!=null&&f.series[j].highlightMouseDown&&e(f);var k=jQuery.Event("jqplotDataRightClick");k.pageX=a.pageX,k.pageY=a.pageY,f.target.trigger(k,i)}}function k(){this.plugins.bubbleRenderer&&this.plugins.bubbleRenderer.highlightCanvas&&(this.plugins.bubbleRenderer.highlightCanvas.resetCanvas(),this.plugins.bubbleRenderer.highlightCanvas=null),this.plugins.bubbleRenderer={highlightedSeriesIndex:null},this.plugins.bubbleRenderer.highlightCanvas=new a.jqplot.GenericCanvas,this.plugins.bubbleRenderer.highlightLabel=null,this.plugins.bubbleRenderer.highlightLabelCanvas=a('<div style="position:absolute;"></div>');var b=this._gridPadding.top,c=this._gridPadding.left,d=this._plotDimensions.width-this._gridPadding.left-this._gridPadding.right,e=this._plotDimensions.height-this._gridPadding.top-this._gridPadding.bottom;this.plugins.bubbleRenderer.highlightLabelCanvas.css({top:b,left:c,width:d+"px",height:e+"px"}),this.eventCanvas._elem.before(this.plugins.bubbleRenderer.highlightCanvas.createElement(this._gridPadding,"jqplot-bubbleRenderer-highlight-canvas",this._plotDimensions,this)),this.eventCanvas._elem.before(this.plugins.bubbleRenderer.highlightLabelCanvas);var f=this.plugins.bubbleRenderer.highlightCanvas.setContext()}function l(b,c,d){d=d||{},d.axesDefaults=d.axesDefaults||{},d.seriesDefaults=d.seriesDefaults||{};var e=!1;if(d.seriesDefaults.renderer==a.jqplot.BubbleRenderer)e=!0;else if(d.series)for(var f=0;f<d.series.length;f++)d.series[f].renderer==a.jqplot.BubbleRenderer&&(e=!0);e&&(d.axesDefaults.renderer=a.jqplot.BubbleAxisRenderer,d.sortData=!1)}var b=function(a){return Math.max.apply(Math,a)},c=function(a){return Math.min.apply(Math,a)};a.jqplot.BubbleRenderer=function(){a.jqplot.LineRenderer.call(this)},a.jqplot.BubbleRenderer.prototype=new a.jqplot.LineRenderer,a.jqplot.BubbleRenderer.prototype.constructor=a.jqplot.BubbleRenderer,a.jqplot.BubbleRenderer.prototype.init=function(b,c){this.varyBubbleColors=!0,this.autoscaleBubbles=!0,this.autoscaleMultiplier=1,this.autoscalePointsFactor=-0.07,this.escapeHtml=!0,this.highlightMouseOver=!0,this.highlightMouseDown=!1,this.highlightColors=[],this.bubbleAlpha=1,this.highlightAlpha=null,this.bubbleGradients=!1,this.showLabels=!0,this.radii=[],this.maxRadius=0,this._highlightedPoint=null,this.labels=[],this.bubbleCanvases=[],this._type="bubble",b.highlightMouseDown&&b.highlightMouseOver==null&&(b.highlightMouseOver=!1),a.extend(!0,this,b),this.highlightAlpha==null&&(this.highlightAlpha=this.bubbleAlpha,this.bubbleGradients&&(this.highlightAlpha=.35)),this.autoscaleMultiplier=this.autoscaleMultiplier*Math.pow(this.data.length,this.autoscalePointsFactor),this._highlightedPoint=null;var d;for(var e=0;e<this.data.length;e++){var l=null,m=this.data[e];this.maxRadius=Math.max(this.maxRadius,m[2]),m[3]&&typeof m[3]=="object"&&(l=m[3].color),l==null&&this.seriesColors[e]!=null&&(l=this.seriesColors[e]),l&&this.bubbleAlpha<1&&(d=a.jqplot.getColorComponents(l),l="rgba("+d[0]+", "+d[1]+", "+d[2]+", "+this.bubbleAlpha+")"),l&&(this.seriesColors[e]=l)}this.varyBubbleColors||(this.seriesColors=[this.color]),this.colorGenerator=new a.jqplot.ColorGenerator(this.seriesColors);if(this.highlightColors.length==0)for(var e=0;e<this.seriesColors.length;e++){var n=a.jqplot.getColorComponents(this.seriesColors[e]),o=[n[0],n[1],n[2]],p=o[0]+o[1]+o[2];for(var q=0;q<3;q++)o[q]=p>570?o[q]*.8:o[q]+.3*(255-o[q]),o[q]=parseInt(o[q],10);this.highlightColors.push("rgba("+o[0]+","+o[1]+","+o[2]+", "+this.highlightAlpha+")")}this.highlightColorGenerator=new a.jqplot.ColorGenerator(this.highlightColors);var r={fill:!0,isarc:!0,angle:this.shadowAngle,alpha:this.shadowAlpha,closePath:!0};this.renderer.shadowRenderer.init(r),this.canvas=new a.jqplot.DivCanvas,this.canvas._plotDimensions=this._plotDimensions,c.eventListenerHooks.addOnce("jqplotMouseMove",f),c.eventListenerHooks.addOnce("jqplotMouseDown",g),c.eventListenerHooks.addOnce("jqplotMouseUp",h),c.eventListenerHooks.addOnce("jqplotClick",i),c.eventListenerHooks.addOnce("jqplotRightClick",j),c.postDrawHooks.addOnce(k)},a.jqplot.BubbleRenderer.prototype.setGridData=function(a){var c=this._xaxis.series_u2p,d=this._yaxis.series_u2p,e=this._plotData;this.gridData=[];var f=[];this.radii=[];var g=Math.min(a._height,a._width);for(var h=0;h<this.data.length;h++)e[h]!=null&&(this.gridData.push([c.call(this._xaxis,e[h][0]),d.call(this._yaxis,e[h][1]),e[h][2]]),this.radii.push([h,e[h][2]]),f.push(e[h][2]));var i,j,k=this.maxRadius=b(f),l=this.gridData.length;if(this.autoscaleBubbles)for(var h=0;h<l;h++)j=f[h]/k,i=this.autoscaleMultiplier*g/6,this.gridData[h][2]=i*j;this.radii.sort(function(a,b){return b[1]-a[1]})},a.jqplot.BubbleRenderer.prototype.makeGridData=function(a,c){var d=this._xaxis.series_u2p,e=this._yaxis.series_u2p,f=[],g=[];this.radii=[];var h=Math.min(c._height,c._width);for(var i=0;i<a.length;i++)a[i]!=null&&(f.push([d.call(this._xaxis,a[i][0]),e.call(this._yaxis,a[i][1]),a[i][2]]),g.push(a[i][2]),this.radii.push([i,a[i][2]]));var j,k,l=this.maxRadius=b(g),m=this.gridData.length;if(this.autoscaleBubbles)for(var i=0;i<m;i++)k=g[i]/l,j=this.autoscaleMultiplier*h/6,f[i][2]=j*k;return this.radii.sort(function(a,b){return b[1]-a[1]}),f},a.jqplot.BubbleRenderer.prototype.draw=function(b,c,d){this.plugins.pointLabels&&(this.plugins.pointLabels.show=!1);var e=d!=undefined?d:{},f=e.shadow!=undefined?e.shadow:this.shadow;this.canvas._elem.empty();for(var g=0;g<this.radii.length;g++){var h=this.radii[g][0],i=null,j=null,k=null,l=null,m=this.data[h],c=this.gridData[h];m[3]&&(typeof m[3]=="object"?i=m[3].label:typeof m[3]=="string"&&(i=m[3])),j=this.colorGenerator.get(h);var n=c[2],o,p;this.shadow&&(o=(.7+c[2]/40).toFixed(1),p=1+Math.ceil(c[2]/15),n+=o*p),this.bubbleCanvases[h]=new a.jqplot.BubbleCanvas,this.canvas._elem.append(this.bubbleCanvases[h].createElement(c[0],c[1],n)),this.bubbleCanvases[h].setContext();var b=this.bubbleCanvases[h]._ctx,q=b.canvas.width/2,r=b.canvas.height/2;this.shadow&&this.renderer.shadowRenderer.draw(b,[q,r,c[2],0,2*Math.PI],{offset:o,depth:p}),this.bubbleCanvases[h].draw(c[2],j,this.bubbleGradients,this.shadowAngle/180*Math.PI);if(i&&this.showLabels){l=a('<div style="position:absolute;" class="jqplot-bubble-label"></div>'),this.escapeHtml?l.text(i):l.html(i),this.canvas._elem.append(l);var s=a(l).outerHeight(),t=a(l).outerWidth(),u=c[1]-.5*s,v=c[0]-.5*t;l.css({top:u,left:v}),this.labels[h]=a(l)}}},a.jqplot.DivCanvas=function(){a.jqplot.ElemContainer.call(this),this._ctx},a.jqplot.DivCanvas.prototype=new a.jqplot.ElemContainer,a.jqplot.DivCanvas.prototype.constructor=a.jqplot.DivCanvas,a.jqplot.DivCanvas.prototype.createElement=function(b,c,d){this._offsets=b;var e="jqplot-DivCanvas";c!=undefined&&(e=c);var f;this._elem?f=this._elem.get(0):f=document.createElement("div"),d!=undefined&&(this._plotDimensions=d);var g=this._plotDimensions.width-this._offsets.left-this._offsets.right+"px",h=this._plotDimensions.height-this._offsets.top-this._offsets.bottom+"px";return this._elem=a(f),this._elem.css({position:"absolute",width:g,height:h,left:this._offsets.left,top:this._offsets.top}),this._elem.addClass(e),this._elem},a.jqplot.DivCanvas.prototype.setContext=function(){return this._ctx={canvas:{width:0,height:0},clearRect:function(){return null}},this._ctx},a.jqplot.BubbleCanvas=function(){a.jqplot.ElemContainer.call(this),this._ctx},a.jqplot.BubbleCanvas.prototype=new a.jqplot.ElemContainer,a.jqplot.BubbleCanvas.prototype.constructor=a.jqplot.BubbleCanvas,a.jqplot.BubbleCanvas.prototype.createElement=function(b,c,d){var e="jqplot-bubble-point",f;this._elem?f=this._elem.get(0):f=document.createElement("canvas"),f.width=d!=null?2*d:f.width,f.height=d!=null?2*d:f.height,this._elem=a(f);var g=b!=null&&d!=null?b-d:this._elem.css("left"),h=c!=null&&d!=null?c-d:this._elem.css("top");return this._elem.css({position:"absolute",left:g,top:h}),this._elem.addClass(e),a.jqplot.use_excanvas&&(window.G_vmlCanvasManager.init_(document),f=window.G_vmlCanvasManager.initElement(f)),this._elem},a.jqplot.BubbleCanvas.prototype.draw=function(b,c,d,e){var f=this._ctx,g=f.canvas.width/2,h=f.canvas.height/2;f.save();if(d&&!a.jqplot.use_excanvas){b*=1.04;var i=a.jqplot.getColorComponents(c),j="rgba("+Math.round(i[0]+.8*(255-i[0]))+", "+Math.round(i[1]+.8*(255-i[1]))+", "+Math.round(i[2]+.8*(255-i[2]))+", "+i[3]+")",k="rgba("+i[0]+", "+i[1]+", "+i[2]+", 0)",l=.35*b,m=g-Math.cos(e)*.33*b,n=h-Math.sin(e)*.33*b,o=f.createRadialGradient(m,n,l,g,h,b);o.addColorStop(0,j),o.addColorStop(.93,c),o.addColorStop(.96,k),o.addColorStop(1,k),f.fillStyle=o,f.fillRect(0,0,f.canvas.width,f.canvas.height)}else{f.fillStyle=c,f.strokeStyle=c,f.lineWidth=1,f.beginPath();var p=2*Math.PI;f.arc(g,h,b,0,p,0),f.closePath(),f.fill()}f.restore()},a.jqplot.BubbleCanvas.prototype.setContext=function(){return this._ctx=this._elem.get(0).getContext("2d"),this._ctx},a.jqplot.BubbleAxisRenderer=function(){a.jqplot.LinearAxisRenderer.call(this)},a.jqplot.BubbleAxisRenderer.prototype=new a.jqplot.LinearAxisRenderer,a.jqplot.BubbleAxisRenderer.prototype.constructor=a.jqplot.BubbleAxisRenderer,a.jqplot.BubbleAxisRenderer.prototype.init=function(b){a.extend(!0,this,b);var c=this._dataBounds,d=0,e=0,f=0,g=0,h=0,i=0,j=0,k=0,l=0,m=0;for(var n=0;n<this._series.length;n++){var o=this._series[n],p=o._plotData;for(var q=0;q<p.length;q++)if(this.name=="xaxis"||this.name=="x2axis"){if(p[q][0]<c.min||c.min==null)c.min=p[q][0],d=n,e=q,i=p[q][2],j=o.maxRadius,m=o.autoscaleMultiplier;if(p[q][0]>c.max||c.max==null)c.max=p[q][0],f=n,g=q,h=p[q][2],k=o.maxRadius,l=o.autoscaleMultiplier}else{if(p[q][1]<c.min||c.min==null)c.min=p[q][1],d=n,e=q,i=p[q][2],j=o.maxRadius,m=o.autoscaleMultiplier;if(p[q][1]>c.max||c.max==null)c.max=p[q][1],f=n,g=q,h=p[q][2],k=o.maxRadius,l=o.autoscaleMultiplier}}var r=i/j,s=h/k,t=c.max-c.min,u=Math.min(this._plotDimensions.width,this._plotDimensions.height),v=r*m/3*t,w=s*l/3*t;c.max+=w,c.min-=v},a.jqplot.preInitHooks.push(l)})(jQuery)