/**
 * jqPlot
 * Pure JavaScript plotting plugin using jQuery
 *
 * Version: 1.0.0b2_r1012
 *
 * Copyright (c) 2009-2011 Chris Leonello
 * jqPlot is currently available for use in all personal or commercial projects 
 * under both the MIT (http://www.opensource.org/licenses/mit-license.php) and GPL 
 * version 2.0 (http://www.gnu.org/licenses/gpl-2.0.html) licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly. 
 *
 * Although not required, the author would appreciate an email letting him 
 * know of any substantial use of jqPlot.  You can reach the author at: 
 * chris at jqplot dot com or see http://www.jqplot.com/info.php .
 *
 * If you are feeling kind and generous, consider supporting the project by
 * making a donation at: http://www.jqplot.com/donate.php .
 *
 * sprintf functions contained in jqplot.sprintf.js by Ash Searle:
 *
 *     version 2007.04.27
 *     author Ash Searle
 *     http://hexmen.com/blog/2007/03/printf-sprintf/
 *     http://hexmen.com/js/sprintf.js
 *     The author (Ash Searle) has placed this code in the public domain:
 *     "This code is unrestricted: you are free to use it however you like."
 *
 * included jsDate library by Chris Leonello:
 *
 * Copyright (c) 2010-2011 Chris Leonello
 *
 * jsDate is currently available for use in all personal or commercial projects 
 * under both the MIT and GPL version 2.0 licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly.
 *
 * jsDate borrows many concepts and ideas from the Date Instance 
 * Methods by Ken Snyder along with some parts of Ken's actual code.
 * 
 * Ken's origianl Date Instance Methods and copyright notice:
 * 
 * Ken Snyder (ken d snyder at gmail dot com)
 * 2008-09-10
 * version 2.0.2 (http://kendsnyder.com/sandbox/date/)     
 * Creative Commons Attribution License 3.0 (http://creativecommons.org/licenses/by/3.0/)
 *
 * jqplotToImage function based on Larry Siden's export-jqplot-to-png.js.
 * Larry has generously given permission to adapt his code for inclusion
 * into jqPlot.
 *
 * Larry's original code can be found here:
 *
 * https://github.com/lsiden/export-jqplot-to-png
 * 
 * 
 */
(function(a){function c(){this.uid=null,this.type=null,this.gridStart=null,this.gridStop=null,this.tooltipWidthFactor=0,this.options={name:null,show:!0,lineWidth:2,lineCap:"round",color:"#666666",shadow:!0,shadowAngle:45,shadowOffset:1,shadowDepth:3,shadowAlpha:"0.07",xaxis:"xaxis",yaxis:"yaxis",showTooltip:!1,showTooltipPrecision:.6,tooltipLocation:"nw",fadeTooltip:!0,tooltipFadeSpeed:"fast",tooltipOffset:4,tooltipFormatString:"%d, %d"}}function d(b){c.call(this),this.type="line";var d={start:[],stop:[]};a.extend(!0,this.options,d,b),this.options.showTooltipPrecision<.01&&(this.options.showTooltipPrecision=.01)}function e(b){c.call(this),this.type="horizontalLine";var d={y:null,xmin:null,xmax:null,xOffset:"6px",xminOffset:null,xmaxOffset:null};a.extend(!0,this.options,d,b),this.options.showTooltipPrecision<.01&&(this.options.showTooltipPrecision=.01)}function f(b){c.call(this),this.type="dashedHorizontalLine";var d={y:null,xmin:null,xmax:null,xOffset:"6px",xminOffset:null,xmaxOffset:null,dashPattern:[8,8]};a.extend(!0,this.options,d,b),this.options.showTooltipPrecision<.01&&(this.options.showTooltipPrecision=.01)}function g(b){c.call(this),this.type="verticalLine";var d={x:null,ymin:null,ymax:null,yOffset:"6px",yminOffset:null,ymaxOffset:null};a.extend(!0,this.options,d,b),this.options.showTooltipPrecision<.01&&(this.options.showTooltipPrecision=.01)}function h(b){c.call(this),this.type="dashedVerticalLine",this.start=null,this.stop=null;var d={x:null,ymin:null,ymax:null,yOffset:"6px",yminOffset:null,ymaxOffset:null,dashPattern:[8,8]};a.extend(!0,this.options,d,b),this.options.showTooltipPrecision<.01&&(this.options.showTooltipPrecision=.01)}function i(b,c,d,e){var f=b.plugins.canvasOverlay,g=f._tooltipElem,h=c.options,i,j;g.html(a.jqplot.sprintf(h.tooltipFormatString,e[0],e[1]));switch(h.tooltipLocation){case"nw":i=d[0]+b._gridPadding.left-g.outerWidth(!0)-h.tooltipOffset,j=d[1]+b._gridPadding.top-h.tooltipOffset-g.outerHeight(!0);break;case"n":i=d[0]+b._gridPadding.left-g.outerWidth(!0)/2,j=d[1]+b._gridPadding.top-h.tooltipOffset-g.outerHeight(!0);break;case"ne":i=d[0]+b._gridPadding.left+h.tooltipOffset,j=d[1]+b._gridPadding.top-h.tooltipOffset-g.outerHeight(!0);break;case"e":i=d[0]+b._gridPadding.left+h.tooltipOffset,j=d[1]+b._gridPadding.top-g.outerHeight(!0)/2;break;case"se":i=d[0]+b._gridPadding.left+h.tooltipOffset,j=d[1]+b._gridPadding.top+h.tooltipOffset;break;case"s":i=d[0]+b._gridPadding.left-g.outerWidth(!0)/2,j=d[1]+b._gridPadding.top+h.tooltipOffset;break;case"sw":i=d[0]+b._gridPadding.left-g.outerWidth(!0)-h.tooltipOffset,j=d[1]+b._gridPadding.top+h.tooltipOffset;break;case"w":i=d[0]+b._gridPadding.left-g.outerWidth(!0)-h.tooltipOffset,j=d[1]+b._gridPadding.top-g.outerHeight(!0)/2;break;default:i=d[0]+b._gridPadding.left-g.outerWidth(!0)-h.tooltipOffset,j=d[1]+b._gridPadding.top-h.tooltipOffset-g.outerHeight(!0)}g.css("left",i),g.css("top",j),h.fadeTooltip?g.stop(!0,!0).fadeIn(h.tooltipFadeSpeed):g.show(),g=null}function j(a,b,c,d){var e=a[0],f=a[1],g=Math.round(c[0]),h=Math.round(c[1]),i=Math.round(b[0]),j=Math.round(b[1]),k=Math.sqrt(Math.pow(g-i,2)+Math.pow(h-j,2)),l=d*k,m=Math.abs((i-g)*(f-h)-(j-h)*(e-g)),n=m<l?!0:!1;return n}function k(a,b,c,d,e){var f=e.plugins.canvasOverlay,g=f.objects,h=g.length,k,l=!1,m;for(var n=0;n<h;n++){k=g[n];if(k.options.showTooltip){var o=j([b.x,b.y],k.gridStart,k.gridStop,k.tooltipWidthFactor);c=[e.axes[k.options.xaxis].series_p2u(b.x),e.axes[k.options.yaxis].series_p2u(b.y)];if(o&&f.highlightObjectIndex==null){switch(k.type){case"line":i(e,k,[b.x,b.y],c);break;case"horizontalLine":case"dashedHorizontalLine":i(e,k,[b.x,k.gridStart[1]],[c[0],k.options.y]);break;case"verticalLine":case"dashedVerticalLine":i(e,k,[k.gridStart[0],b.y],[k.options.x,c[1]]);break;default:}f.highlightObjectIndex=n,l=!0;break}if(o&&f.highlightObjectIndex!==n){m=f._tooltipElem,k.fadeTooltip?m.fadeOut(k.tooltipFadeSpeed):m.hide();switch(k.type){case"line":i(e,k,[b.x,b.y],c);break;case"horizontalLine":case"dashedHorizontalLine":i(e,k,[b.x,k.gridStart[1]],[c[0],k.options.y]);break;case"verticalLine":case"dashedVerticalLine":i(e,k,[k.gridStart[0],b.y],[k.options.x,c[1]]);break;default:}f.highlightObjectIndex=n,l=!0;break}if(o){switch(k.type){case"line":i(e,k,[b.x,b.y],c);break;case"horizontalLine":case"dashedHorizontalLine":i(e,k,[b.x,k.gridStart[1]],[c[0],k.options.y]);break;case"verticalLine":case"dashedVerticalLine":i(e,k,[k.gridStart[0],b.y],[k.options.x,c[1]]);break;default:}l=!0;break}}}!l&&f.highlightObjectIndex!==null&&(m=f._tooltipElem,k=f.getObject(f.highlightObjectIndex),k.fadeTooltip?m.fadeOut(k.tooltipFadeSpeed):m.hide(),f.highlightObjectIndex=null)}var b=0;a.jqplot.CanvasOverlay=function(b){var c=b||{};this.options={show:a.jqplot.config.enablePlugins,deferDraw:!1},this.objects=[],this.objectNames=[],this.canvas=null,this.markerRenderer=new a.jqplot.MarkerRenderer({style:"line"}),this.markerRenderer.init(),this.highlightObjectIndex=null;if(c.objects){var d=c.objects,e;for(var f=0;f<d.length;f++){e=d[f];for(var g in e)switch(g){case"line":this.addLine(e[g]);break;case"horizontalLine":this.addHorizontalLine(e[g]);break;case"dashedHorizontalLine":this.addDashedHorizontalLine(e[g]);break;case"verticalLine":this.addVerticalLine(e[g]);break;case"dashedVerticalLine":this.addDashedVerticalLine(e[g]);break;default:}}}a.extend(!0,this.options,c)},a.jqplot.CanvasOverlay.postPlotInit=function(b,c,d){var e=d||{};this.plugins.canvasOverlay=new a.jqplot.CanvasOverlay(e.canvasOverlay)},d.prototype=new c,d.prototype.constructor=d,e.prototype=new c,e.prototype.constructor=e,f.prototype=new c,f.prototype.constructor=f,g.prototype=new c,g.prototype.constructor=g,h.prototype=new c,h.prototype.constructor=h,a.jqplot.CanvasOverlay.prototype.addLine=function(a){var c=new d(a);c.uid=b++,this.objects.push(c),this.objectNames.push(c.options.name)},a.jqplot.CanvasOverlay.prototype.addHorizontalLine=function(a){var c=new e(a);c.uid=b++,this.objects.push(c),this.objectNames.push(c.options.name)},a.jqplot.CanvasOverlay.prototype.addDashedHorizontalLine=function(a){var c=new f(a);c.uid=b++,this.objects.push(c),this.objectNames.push(c.options.name)},a.jqplot.CanvasOverlay.prototype.addVerticalLine=function(a){var c=new g(a);c.uid=b++,this.objects.push(c),this.objectNames.push(c.options.name)},a.jqplot.CanvasOverlay.prototype.addDashedVerticalLine=function(a){var c=new h(a);c.uid=b++,this.objects.push(c),this.objectNames.push(c.options.name)},a.jqplot.CanvasOverlay.prototype.removeObject=function(b){if(a.type(b)=="number")this.objects.splice(b,1),this.objectNames.splice(b,1);else{var c=a.inArray(b,this.objectNames);c!=-1&&(this.objects.splice(c,1),this.objectNames.splice(c,1))}},a.jqplot.CanvasOverlay.prototype.getObject=function(b){if(a.type(b)=="number")return this.objects[b];var c=a.inArray(b,this.objectNames);if(c!=-1)return this.objects[c]},a.jqplot.CanvasOverlay.prototype.get=a.jqplot.CanvasOverlay.prototype.getObject,a.jqplot.CanvasOverlay.prototype.clear=function(a){this.canvas._ctx.clearRect(0,0,this.canvas.getWidth(),this.canvas.getHeight())},a.jqplot.CanvasOverlay.prototype.draw=function(b){var c,d=this.objects,e=this.markerRenderer,f,g;if(this.options.show){this.canvas._ctx.clearRect(0,0,this.canvas.getWidth(),this.canvas.getHeight());for(var h=0;h<d.length;h++){c=d[h];var i=a.extend(!0,{},c.options);if(c.options.show){e.shadow=c.options.shadow,c.tooltipWidthFactor=c.options.lineWidth/c.options.showTooltipPrecision;switch(c.type){case"line":e.style="line",i.closePath=!1,f=[b.axes[c.options.xaxis].series_u2p(c.options.start[0]),b.axes[c.options.yaxis].series_u2p(c.options.start[1])],g=[b.axes[c.options.xaxis].series_u2p(c.options.stop[0]),b.axes[c.options.yaxis].series_u2p(c.options.stop[1])],c.gridStart=f,c.gridStop=g,e.draw(f,g,this.canvas._ctx,i);break;case"horizontalLine":if(c.options.y!=null){e.style="line",i.closePath=!1;var j=b.axes[c.options.xaxis],k,l,m=b.axes[c.options.yaxis].series_u2p(c.options.y),n=c.options.xminOffset||c.options.xOffset,o=c.options.xmaxOffset||c.options.xOffset;c.options.xmin!=null?k=j.series_u2p(c.options.xmin):n!=null&&(a.type(n)=="number"?k=j.series_u2p(j.min+n):a.type(n)=="string"&&(k=j.series_u2p(j.min)+parseFloat(n))),c.options.xmax!=null?l=j.series_u2p(c.options.xmax):o!=null&&(a.type(o)=="number"?l=j.series_u2p(j.max-o):a.type(o)=="string"&&(l=j.series_u2p(j.max)-parseFloat(o))),l!=null&&k!=null&&(c.gridStart=[k,m],c.gridStop=[l,m],e.draw([k,m],[l,m],this.canvas._ctx,i))}break;case"dashedHorizontalLine":var p=c.options.dashPattern,q=0;for(var r=0;r<p.length;r++)q+=p[r];if(c.options.y!=null){e.style="line",i.closePath=!1;var j=b.axes[c.options.xaxis],k,l,m=b.axes[c.options.yaxis].series_u2p(c.options.y),n=c.options.xminOffset||c.options.xOffset,o=c.options.xmaxOffset||c.options.xOffset;c.options.xmin!=null?k=j.series_u2p(c.options.xmin):n!=null&&(a.type(n)=="number"?k=j.series_u2p(j.min+n):a.type(n)=="string"&&(k=j.series_u2p(j.min)+parseFloat(n))),c.options.xmax!=null?l=j.series_u2p(c.options.xmax):o!=null&&(a.type(o)=="number"?l=j.series_u2p(j.max-o):a.type(o)=="string"&&(l=j.series_u2p(j.max)-parseFloat(o)));if(l!=null&&k!=null){c.gridStart=[k,m],c.gridStop=[l,m];var s=Math.ceil((l-k)/q),t=k,u;for(var r=0;r<s;r++)for(var v=0;v<p.length;v+=2)u=t+p[v],e.draw([t,m],[u,m],this.canvas._ctx,i),t+=p[v],v<p.length-1&&(t+=p[v+1])}}break;case"verticalLine":if(c.options.x!=null){e.style="line",i.closePath=!1;var w=b.axes[c.options.yaxis],x,y,z=b.axes[c.options.xaxis].series_u2p(c.options.x),A=c.options.yminOffset||c.options.yOffset,B=c.options.ymaxOffset||c.options.yOffset;c.options.ymin!=null?x=w.series_u2p(c.options.ymin):A!=null&&(a.type(A)=="number"?x=w.series_u2p(w.min-A):a.type(A)=="string"&&(x=w.series_u2p(w.min)-parseFloat(A))),c.options.ymax!=null?y=w.series_u2p(c.options.ymax):B!=null&&(a.type(B)=="number"?y=w.series_u2p(w.max+B):a.type(B)=="string"&&(y=w.series_u2p(w.max)+parseFloat(B))),y!=null&&x!=null&&(c.gridStart=[z,x],c.gridStop=[z,y],e.draw([z,x],[z,y],this.canvas._ctx,i))}break;case"dashedVerticalLine":var p=c.options.dashPattern,q=0;for(var r=0;r<p.length;r++)q+=p[r];if(c.options.x!=null){e.style="line",i.closePath=!1;var w=b.axes[c.options.yaxis],x,y,z=b.axes[c.options.xaxis].series_u2p(c.options.x),A=c.options.yminOffset||c.options.yOffset,B=c.options.ymaxOffset||c.options.yOffset;c.options.ymin!=null?x=w.series_u2p(c.options.ymin):A!=null&&(a.type(A)=="number"?x=w.series_u2p(w.min-A):a.type(A)=="string"&&(x=w.series_u2p(w.min)-parseFloat(A))),c.options.ymax!=null?y=w.series_u2p(c.options.ymax):B!=null&&(a.type(B)=="number"?y=w.series_u2p(w.max+B):a.type(B)=="string"&&(y=w.series_u2p(w.max)+parseFloat(B)));if(y!=null&&x!=null){c.gridStart=[z,x],c.gridStop=[z,y];var s=Math.ceil((x-y)/q),C=(s*q-(x-y))/2,t=x,u,D,E;for(var r=0;r<s;r++)for(var v=0;v<p.length;v+=2)u=t-p[v],u<y&&(u=y),t<y&&(t=y),e.draw([z,t],[z,u],this.canvas._ctx,i),t-=p[v],v<p.length-1&&(t-=p[v+1])}}break;default:}}}}},a.jqplot.CanvasOverlay.postPlotDraw=function(){var b=this.plugins.canvasOverlay;b&&b.highlightCanvas&&(b.highlightCanvas.resetCanvas(),b.highlightCanvas=null),b.canvas=new a.jqplot.GenericCanvas,this.eventCanvas._elem.before(b.canvas.createElement(this._gridPadding,"jqplot-overlayCanvas-canvas",this._plotDimensions,this)),b.canvas.setContext(),b.deferDraw||b.draw(this);var c=document.createElement("div");b._tooltipElem=a(c),c=null,b._tooltipElem.addClass("jqplot-canvasOverlay-tooltip"),b._tooltipElem.css({position:"absolute",display:"none"}),this.eventCanvas._elem.before(b._tooltipElem),this.eventCanvas._elem.bind("mouseleave",{elem:b._tooltipElem},function(a){a.data.elem.hide()});var b=null},a.jqplot.postInitHooks.push(a.jqplot.CanvasOverlay.postPlotInit),a.jqplot.postDrawHooks.push(a.jqplot.CanvasOverlay.postPlotDraw),a.jqplot.eventListenerHooks.push(["jqplotMouseMove",k])})(jQuery)